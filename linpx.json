[
    {
        "bookSourceComment": "ğŸ¦Š Linpx ä¹¦æºï¼ˆå•ç¯‡ï¼‰ï¼ˆæ›´æ–°ğŸ“†ï¼š2026/02/22ï¼‰\n\nä¹¦æºç‰ˆæœ¬ï¼š262\nä½¿ç”¨è¯´æ˜ï¼šğŸ“Œé˜…è¯» Plus 3.26.0129 ç‰ˆæœ¬å¯ç”¨\nå¯ç”¨åŠŸèƒ½ï¼šâœ…æœç´¢âœ…å‘ç°âœ…æ·»åŠ ç½‘å€âœ…è®¢é˜…æº\næœç´¢å°è¯´ï¼šâœ…å•ç¯‡âŒç³»åˆ—âœ…ä½œè€…âœ…æ ‡ç­¾\nå‘ç°å°è¯´ï¼šâœ…æ¨èâœ…æœ€æ–°âœ…æ›´æ–°ä¹¦æº\næ·»åŠ ç½‘å€ï¼šâœ…å°è¯´âœ…ä½œè€…\nè®¢é˜…ç”¨æ³•ï¼šç‚¹å‡»è®¢é˜…æºæ‰“å¼€å°è¯´ï¼Œç‚¹å‡»ã€æ·»åŠ åˆ°ä¹¦æ¶ã€‘æŒ‰é’®æ·»åŠ å°è¯´åˆ°ä¹¦æ¶\næ¸©é¦¨æç¤ºï¼šâš ï¸Linpx æœç´¢æš‚æ—¶ä¸æ”¯æŒç³»åˆ—å°è¯´åç§°ï¼Œæ·»åŠ ç³»åˆ—å°è¯´åï¼Œæ— æ³•å†æ¬¡é€šè¿‡æœç´¢è·å–å¹¶æ›´æ–°ç›®å½•\n\nä¹¦æºå‘å¸ƒï¼šPixiv ä¹¦æºé¢‘é“ https://t.me/PixivSource\nå…½äººé˜…è¯»é¢‘é“ https://t.me/FurryReading\né¡¹ç›®åœ°å€ï¼šhttps://github.com/DowneyRem/PixivSource\nä½¿ç”¨æ•™ç¨‹ï¼šhttps://pixivsource.pages.dev/Linpx\n\nè§„åˆ™è®¢é˜…ï¼šImport è®¢é˜…æº\nhttps://cdn.jsdelivr.net/gh/DowneyRem/PixivSource@main/import.json\nhttps://raw.githubusercontent.com/DowneyRem/PixivSource/main/import.json\n\nâš™ï¸ ä¹¦æºè®¾ç½®ï¼š\nè®¾ç½®ï¼šæ‰“å¼€å°è¯´ - èœå• - ç™»å½• - ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®",
        "bookSourceGroup": "ğŸ” Pixiv,ğŸ² Furry",
        "bookSourceName": "ğŸ¦Š Linpx",
        "bookSourceType": 0,
        "bookSourceUrl": "https://furrynovel.ink",
        "bookUrlPattern": "(https?://)?(api\\.|www\\.)?(furrynovel\\.(ink|xyz))/(pn|pixiv/(novel|user))/\\d+(/cache)?",
        "concurrentRate": "30/5000",
        "customButton": false,
        "customOrder": 3,
        "enabled": true,
        "enabledCookieJar": true,
        "enabledExplore": true,
        "eventListener": true,
        "exploreUrl": "@js:\nli = [\n    {\"ğŸ’¯ æ¨è\": \"https://api.furrynovel.ink/fav/user/cache\"},\n    {\"ğŸ†• æœ€æ–°\": \"https://api.furrynovel.ink/pixiv/novels/recent/cache?page={{page}}\"},\n    {\"ğŸ”„ éšä¾¿\": \"https://furrynovel.ink\"},\n    {\"ğŸ†™ æ›´æ–°\": \"https://cdn.jsdelivr.net/gh/DowneyRem/PixivSource@main/linpx.json\"},\n    {\"ğŸ“™ ä¹¦æºç›¸å…³ ğŸ“™\": \"\"},\n    {\"ğŸ  ä¸»é¡µ\": \"https://pixivsource.pages.dev\"},\n    {\"ğŸ”° æŒ‡å—\": \"https://pixivsource.pages.dev/Linpx\"},\n    {\"ğŸ åé¦ˆ\": \"https://github.com/DowneyRem/PixivSource/issues\"},\n    {\"ğŸ’° æ‰“èµ\": \"https://pixivsource.pages.dev/Sponsor\"},\n]\n\n// æ ¼å¼åŒ–å‘ç°åœ°å€\nli.forEach(item => {\n    item.title = Object.keys(item)[0]\n    item.url = Object.values(item)[0]\n    delete item[Object.keys(item)[0]]\n    item.style = {}\n    item.style.layout_flexGrow = 1\n    item.style.layout_flexShrink = 1\n    item.style.layout_alignSelf = \"auto\"\n    item.style.layout_wrapBefore = \"false\"\n    if (item.url === \"\") {\n        item.style.layout_flexBasisPercent = 1\n    } else {\n        item.style.layout_flexBasisPercent = -1\n    }\n})\nJSON.stringify(li)",
        "header": "",
        "jsLib": "var cacheSaveSeconds = 30*24*60*60  // é•¿æœŸç¼“å­˜ 30 å¤©\nvar cacheTempSeconds = 10*60*1000   // å†·å´æ—¶é—´ 10 åˆ†é’Ÿ\n\nfunction cacheGetAndSet(key, supplyFunc, requestUpdate) {\n    const {java, cache} = this\n    let timestamp = 0\n    let v = this.getFromCacheObject(key)\n    if (Array.isArray(v)) {\n        try {\n            timestamp = v[0].timestamp\n        } catch (e) {\n            timestamp = 0\n        }\n    } else if (v) {\n        timestamp = v.timestamp\n    }\n\n    const isExpired = v && (new Date().getTime() >= timestamp + cacheTempSeconds)\n    const isError = v && (v.error === true) && isExpired\n    requestUpdate = requestUpdate && isExpired\n\n    if (!v || requestUpdate || isError) {\n        v = supplyFunc()\n        let now = new Date().getTime()\n        // getAjaxJson getWebviewJson æ—¶é—´æˆ³å†™å…¥å¯¹è±¡æœ¬èº«\n        if (!Array.isArray(v)) {\n            v = Object.assign({timestamp: now}, v)\n        }\n        // else {\n        //     // getAjaxAllJson æ—¶é—´æˆ³å†™å…¥ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆè¯»å–æ—¶ v[0].timestampï¼‰// ä¸é‡å¤å†™å…¥\n        //     if (v.length > 0) v[0] = Object.assign({timestamp: now}, v[0])\n        // }\n        this.putInCacheObject(key, v, cacheSaveSeconds)\n    }\n    return v\n}\n\nfunction putInCache(name, object, saveSeconds) {\n    const {java, cache} = this\n    if (saveSeconds === undefined) saveSeconds = 0\n    if (object) {\n        cache.put(name, object, saveSeconds)\n    }\n}\nfunction getFromCache(name) {\n    const {java, cache} = this\n    let object = cache.get(name)\n    if (object === undefined) return null  // å…¼å®¹æºé˜…\n    return object\n}\n\nfunction putInCacheObject(objectName, object, saveSeconds) {\n    const {java, cache} = this\n    if (object === undefined) object = null\n    if (saveSeconds === undefined) saveSeconds = 0\n    cache.put(objectName, JSON.stringify(object), saveSeconds)\n}\nfunction getFromCacheObject(objectName) {\n    const {java, cache} = this\n    let object = cache.get(objectName)\n    if (object === undefined) return null  // å…¼å®¹æºé˜…\n    return JSON.parse(object)\n}\n\nfunction isHtmlString(str) {\n    return str.startsWith(\"<!DOCTYPE html>\")\n}\nfunction isJsonString(str) {\n    try {\n        let result = JSON.parse(str)\n        return typeof result === \"object\" && result !== null\n    } catch(e) {\n        return false\n    }\n}\n\nfunction getAjaxJson(url, requestUpdate) {\n    const {java, cache} = this\n    return this.cacheGetAndSet(url, () => {\n        return JSON.parse(java.ajax(url))\n    }, requestUpdate)\n}\nfunction getAjaxAllJson(urls, requestUpdate) {\n    const {java, cache} = this\n    let batchKey = JSON.stringify(urls)\n    return this.cacheGetAndSet(batchKey, () => {\n        let results = []\n        let now = new Date().getTime()\n        let responses = java.ajaxAll(urls)\n        for (let i in urls) {\n            let data = JSON.parse(responses[i].body())\n            data = Object.assign({timestamp: now}, data)\n            results.push(data)\n            this.putInCacheObject(urls[i], data, cacheSaveSeconds)\n        }\n        return results\n    }, requestUpdate)\n}\nfunction getAjaxParseJson(url, parseFunc, requestUpdate) {\n    const {java, cache} = this\n    return this.cacheGetAndSet(url, () => {\n        let resp = parseFunc(java.ajax(url))\n        if (resp instanceof Object) return resp\n        else return JSON.parse(resp)\n    }, requestUpdate)\n}\n// function getWebviewJson(url, parseFunc, requestUpdate) {\n//     const {java, cache} = this\n//     return this.cacheGetAndSet(url, () => {\n//         let html = java.webView(null, url, null)\n//         return JSON.parse(parseFunc(html))\n//     }, requestUpdate)\n// }\nfunction getWebviewJson(url) {\n    const {java, cache} = this\n    return this.cacheGetAndSet(url, () => {\n        let html = java.webView(null, url, null)\n        return JSON.parse((html.match(new RegExp(\">\\\\[{.*?}]<\"))[0].replace(\">\", \"\").replace(\"<\", \"\")))\n    })\n}\n\nfunction getWebViewUA() {\n    const {java, cache} = this\n    let userAgent = this.getFromCache(\"userAgent\")\n    if (userAgent) return String(userAgent)\n\n    userAgent = String(java.getWebViewUA())\n    if (userAgent.includes(\"Windows NT 10.0; Win64; x64\")) {\n        userAgent = \"Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Mobile Safari/537.36\"\n    }\n    userAgent += \" Reader\"\n    // java.log(`userAgent=${userAgent}`)\n    this.putInCache(\"userAgent\", userAgent, cacheSaveSeconds/7)\n    return String(userAgent)\n}\nfunction startBrowser(url, title) {\n    const {java} = this\n    if (!title) title = url\n    let msg = \"\"\n    let headers = {}\n    headers[\"User-Agent\"] = this.getWebViewUA()\n    headers[\"Referer\"] = \"https://furrynovel.ink/\"\n\n    if (url.includes(\"github.com\") || url.includes(\"github.io\")) {\n        msg += \"\\n\\nå³å°†æ‰“å¼€ Github\\nè¯·ç¡®è®¤å·²å¼€å¯ä»£ç†/æ¢¯å­/VPNç­‰\"\n    }\n    this.sleepToast(msg, 0.01)\n    java.startBrowser(`${url}, ${JSON.stringify({headers: headers})}`, title)\n}\n\nfunction urlNovelUrl(novelId) {\n    return `https://furrynovel.ink/pixiv/novel/${novelId}/cache`\n}\nfunction urlNovelDetailed(novelId) {\n    return `https://api.furrynovel.ink/pixiv/novel/${novelId}/cache`\n}\nfunction urlNovelsDetailed(nidList) {\n    return `https://api.furrynovel.ink/pixiv/novels/cache?${nidList.map(v => \"ids[]=\" + v).join(\"&\")}`\n}\nfunction urlNovelComments(novelId) {\n    return `https://api.furrynovel.ink/pixiv/novel/${novelId}/comments`\n}\n\nfunction urlSourceUrl(novelId) {\n    return `https://www.pixiv.net/novel/show.php?id=${novelId}`\n}\n\nfunction urlSeriesUrl(seriesId) {\n    return `https://www.pixiv.net/novel/series/${seriesId}`\n}\nfunction urlSeriesDetailed(seriesId) {\n    return `https://api.furrynovel.ink/pixiv/series/${seriesId}/cache`\n}\n\nfunction urlUserUrl(userId) {\n    return `https://furrynovel.ink/pixiv/user/${userId}/cache`\n}\nfunction urlUserDetailed(userId) {\n    return `https://api.furrynovel.ink/pixiv/user/${userId}/cache`\n}\nfunction urlUsersDetailed(uidList) {\n    return `https://api.furrynovel.ink/pixiv/users/cache?${uidList.map(v => \"ids[]=\" + v).join(\"&\")}`\n}\n\nfunction urlSearchNovel(novelName, page) {\n    return `https://api.furrynovel.ink/pixiv/search/novel/${novelName}/cache?page=${page}`\n}\nfunction urlSearchUsers(userName) {\n    return `https://api.furrynovel.ink/pixiv/search/user/${userName}/cache`\n}\n\nfunction urlCoverUrl(pxImgUrl) {\n    let url = `https://pximg.furrynovel.ink/?url=${pxImgUrl}&w=800`\n    let headers = {\"Referer\": \"https://furrynovel.ink/\"}\n    return `${url}, ${JSON.stringify({headers: headers})}`\n}\n\nfunction urlIllustUrl(illustId) {\n    return `https://www.pixiv.net/artworks/${illustId}`\n}\nfunction urlIllustDetailed(illustId) {\n    return `https://www.pixiv.net/ajax/illust/${illustId}?lang=zh`\n}\n// ç›´è¿åŠŸèƒ½å‚è€ƒè‡ª æ´›å¨…æ©™çš„é˜…è¯»ä»“åº“\n// https://github.com/Luoyacheng/yuedu\n// å…¶ç›´è¿åŠŸèƒ½å‚è€ƒè‡ª PixEz Flutter\n// https://github.com/Notsfsssf/pixez-flutter\nfunction urlIP(url) {\n    const {java, cache} = this\n    url = url.replace(\"http://\", \"https://\").replace(\"www.pixiv.net\", \"210.140.139.155\")\n    let headers = {\n        \"User-Agent\": this.getWebViewUA(),\n        \"X-Requested-With\": \"XMLHttpRequest\",\n        \"Host\": \"www.pixiv.net\",\n        \"Referer\": \"https://www.pixiv.net/\"\n    }\n    return `${url}, ${JSON.stringify({headers: headers})}`\n}\nfunction urlPixivCoverUrl(url) {\n    const {java, cache} = this\n    if (url && !url.trim()) return \"\"\n    let headers = {\"Referer\": \"https://www.pixiv.net/\"}\n\n    if (url.trim()) {\n        if (url.includes(\"i.pximg.net\")) {\n            url = url.replace(\"https://i.pximg.net\", \"https://210.140.139.133\")\n            headers.Host = \"i.pximg.net\"\n        } else {\n            url = url.replace(\"https://s.pximg.net\", \"https://210.140.139.133\")\n            headers.Host = \"s.pximg.net\"\n        }\n    }\n    return `${url}, ${JSON.stringify({headers: headers})}`\n}\nfunction urlIllustOriginal(illustId, order) {\n    const {java, cache} = this\n    if (!order || order <= 1) order = 1\n    let illustOriginal = \"\"\n\n    let resp = this.getAjaxJson(this.urlIP(urlIllustDetailed(illustId)))\n    try {\n        illustOriginal = resp.body.urls.original\n    } catch (e) {\n        try {\n            let illustThumb = resp.body.userIllusts[illustId].url\n            let date = illustThumb.match(\"\\\\d{4}\\\\/\\\\d{2}\\\\/\\\\d{2}\\\\/\\\\d{2}\\\\/\\\\d{2}\\\\/\\\\d{2}\")[0]\n            illustOriginal = `https://i.pximg.net/img-master/img/${date}/${illustId}_p0_master1200.jpg`\n        } catch (e) {}\n    }\n\n    if (illustOriginal.split(\",\")[0] === \"\") return \"\"\n    return this.urlPixivCoverUrl(illustOriginal.replace(`_p0`, `_p${order - 1}`))\n}\n\nfunction addZero(num) {\n    return String(num).padStart(2, '0')\n}\nfunction dateFormat(str) {\n    let time = new Date(str);\n    let Y = time.getFullYear() + \"å¹´\";\n    let M = this.addZero(time.getMonth() + 1) + \"æœˆ\";\n    let D = this.addZero(time.getDate()) + \"æ—¥\";\n    return Y + M + D;\n}\nfunction timeFormat(str) {\n    let time = new Date(str);\n    let YY = time.getFullYear()\n    let MM = this.addZero(time.getMonth() + 1)\n    let DD = this.addZero(time.getDate())\n    let hh = this.addZero(time.getHours())\n    let mm = this.addZero(time.getMinutes())\n    let ss = this.addZero(time.getSeconds())\n    return `${YY}-${MM}-${DD} ${hh}:${mm}:${ss}`\n}\nfunction timeTextFormat(text) {\n    return `${text.slice(0, 10)} ${text.slice(11, 19)}`\n}\n\nfunction sleep(seconds) {\n    return Packages.java.lang.Thread.sleep(1000*seconds)\n}\nfunction sleepToast(text, seconds) {\n    let {java} = this\n    java.log(text)\n    java.longToast(text)\n    if (seconds === undefined) {seconds = 0.01}\n    this.sleep(seconds)\n}\n\nfunction setDefaultSettings() {\n    const {java, cache} = this\n    let settings = {}\n    settings.SEARCH_AUTHOR = false      // æœç´¢ï¼šé»˜è®¤æœç´¢ä½œè€…åç§°\n    settings.CONVERT_CHINESE = true     // æœç´¢ï¼šæœç´¢æ—¶è¿›è¡Œç¹ç®€è½¬æ¢\n\n    settings.MORE_INFORMATION = false   // è¯¦æƒ…ï¼šä¹¦ç±ç®€ä»‹æ˜¾ç¤ºæ›´å¤šä¿¡æ¯\n    settings.SHOW_ORIGINAL_LINK = true  // ç›®å½•ï¼šæ˜¾ç¤ºåŸå§‹é“¾æ¥ï¼Œä½†ä¼šå¢åŠ å¤§é‡è¯·æ±‚\n\n    settings.REPLACE_TITLE_MARKS = true // æ­£æ–‡ï¼šæ³¨éŸ³å†…å®¹ä¸ºæ±‰å­—æ—¶ï¼Œæ›¿æ¢ä¸ºä¹¦åå·\n    settings.SHOW_CAPTIONS = true       // æ­£æ–‡ï¼šç« é¦–æ˜¾ç¤ºæè¿°\n\n    settings.DEBUG = false              // å…¨å±€ï¼šè°ƒè¯•æ¨¡å¼\n\n    this.putInCacheObject(\"linpxSettings\", settings)\n    return settings\n}\n\nfunction updateSource() {\n    const {java, source} = this\n    java.longToast(\"ğŸ†™ æ›´æ–°ä¹¦æº\\n\\nJsdelivr CDN æ›´æ–°æœ‰å»¶è¿Ÿ\\nGithub æ›´æ–°éœ€ä»£ç†\")\n    let onlineSource, comment, sourceName, sourceNameCapitalize, index = 0\n    if (source.bookSourceUrl.includes(\"pixiv\")) sourceName = \"pixiv\"\n    else if (source.bookSourceUrl.includes(\"furrynovel\")) sourceName = \"linpx\"\n    sourceNameCapitalize = sourceName[0].toUpperCase() + sourceName.substring(1)\n\n    if (source.bookSourceName.includes(\"å¤‡ç”¨\")) index = 1\n    else if (source.bookSourceName.includes(\"æ¼«ç”»\")) index = 2\n    if (source.bookSourceUrl.includes(\"furrynovel.com\")) {\n        sourceNameCapitalize = \"FurryNovel\"\n        index = 1\n    }\n\n    try {\n        let updateUrl = `https://cdn.jsdelivr.net/gh/DowneyRem/PixivSource@main/${sourceName}.json`\n        onlineSource = JSON.parse(java.get(updateUrl,{'User-Agent': 'Mozilla/5.0 (Linux; Android 14)','X-Requested-With': 'XMLHttpRequest'}).body())[index]\n    } catch (e) {\n        try {\n            let updateUrl = `https://raw.githubusercontent.com/DowneyRem/PixivSource/main/${sourceName}.json`\n            onlineSource = JSON.parse(java.get(updateUrl,{'User-Agent': 'Mozilla/5.0 (Linux; Android 14)','X-Requested-With': 'XMLHttpRequest'}).body())[index]\n        } catch (e) {\n            onlineSource = {lastUpdateTime: new Date().getTime(), bookSourceComment: source.bookSourceComment}\n        }\n    }\n    comment = onlineSource.bookSourceComment.split(\"\\n\")\n    // onlineSource = source\n    // comment = source.bookSourceComment.split(\"\\n\")\n\n    let htm = `\n<!DOCTYPE html>\n<html lang=\"zh-CN\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>æ›´æ–° ${source.bookSourceName} ä¹¦æº</title>\n    <style> \n    table { text-align: center; margin: 0 auto; } .ann { display: flex; justify-content: center; align-items: center; height: 5vh; } \n    button { background-color: rgb(76, 175, 80); color: white; border: none; border-radius: 4px; height: 6vh; width: 30vw; overflow: hidden; } \n    button span { cursor: pointer; display: inline-block; position: relative; transition: 0.4s; } \n    button span:after { content: '>'; position: absolute; opacity: 0; top: 0; right: 30px; transition: 0.2s; } \n    button:active span { padding-right: 20px; } \n    button:active span:after { opacity: 1; right: -40px; }\n    </style>\n</head>\n\n<body>\n    <table border=\"1\" cellspacing=\"0\">\n        <th colspan=\"2\"> ${source.bookSourceName} ä¹¦æº \n        <a href=\"https://pixivsource.pages.dev/${sourceNameCapitalize}\">ğŸ”° ä½¿ç”¨æŒ‡å—</a>\n        || <a href=\"https://pixivsource.pages.dev/Sponsor\">â¤ï¸ èµåŠ©å¼€å‘</a>\n        </th>\n        <tr>\n            <td>â˜ï¸ è¿œç¨‹ç‰ˆæœ¬ï¼š${onlineSource.bookSourceComment.split(\"\\n\")[2].replace(\"ä¹¦æºç‰ˆæœ¬ï¼š\", \"\")}</td>\n            <td>ğŸ“† æ›´æ–°ï¼š${timeFormat(onlineSource.lastUpdateTime)}</td>\n        </tr>\n        <tr>\n            <td>ğŸ“¥ æœ¬åœ°ç‰ˆæœ¬ï¼š${source.bookSourceComment.split(\"\\n\")[2].replace(\"ä¹¦æºç‰ˆæœ¬ï¼š\", \"\")}</td>\n            <td>ğŸ“† æ›´æ–°ï¼š${timeFormat(source.lastUpdateTime)}</td>\n        </tr> \n        <tr><td colspan=\"2\" style=\"text-align: left;\">${comment.slice(3, 10).join(\"<br>\")}</td></tr>\n        <tr><td colspan=\"2\" style=\"text-align: left;\">${comment.slice(comment.length-2, comment.length).join(\"<br>\")}</td></tr>\n    </table>\n    \n    <table border=\"0\" cellspacing=\"20\">\n        <th colspan=\"2\"> æ›´æ–° ${source.bookSourceName} ä¹¦æº </th>\n        <tr><td><div class=\"ann\">\n            <a href=\"legado://import/importonline?src=https://cdn.jsdelivr.net/gh/DowneyRem/PixivSource@main/${sourceName}.json\">\n            <button><span>æ›´æ–°ä¹¦æº<br>(Jsdelivr CDN)</span></button>\n            </a></div></td>\n            \n            <td><div class=\"ann\">\n            <a href=\"legado://import/importonline?src=https://cdn.jsdelivr.net/gh/DowneyRem/PixivSource@main/btsrk.json\">\n            <button><span>æ›´æ–°è®¢é˜…<br>(Jsdelivr CDN)</span></button>\n            </a></div></td>\n        </tr>\n        \n        <tr><td><div class=\"ann\">\n            <a href=\"legado://import/importonline?src=https://raw.githubusercontent.com/DowneyRem/PixivSource/main/${sourceName}.json\">\n            <button><span>ä¹¦æºé“¾æ¥<br>(GitHub)</span></button>\n            </a></div></td>\n            \n            <td><div class=\"ann\">\n            <a href=\"legado://import/importonline?src=https://raw.githubusercontent.com/DowneyRem/PixivSource/main/btsrk.json\">\n            <button><span>è®¢é˜…é“¾æ¥<br>(GitHub)</span></button>\n            </a></div></td>\n        </tr>\n        \n        <tr><td><div class=\"ann\">\n            <a href=\"legado://import/importonline?src=https://codeberg.org/DowneyRem/PixivSource/raw/branch/main/${sourceName}.json\">\n            <button><span>å¤‡ç”¨ä¹¦æºé“¾æ¥<br>(Codeberg)</span></button>\n            </a></div></td>\n            \n            <td><div class=\"ann\">\n            <a href=\"legado://import/importonline?src=https://codeberg.org/DowneyRem/PixivSource/raw/branch/main/btsrk.json\">\n            <button><span>å¤‡ç”¨è®¢é˜…é“¾æ¥<br>(Codeberg)</span></button>\n            </a></div></td>\n        </tr>\n    </table>\n</body>\n</html>`\n    java.startBrowser(`data:text/html;charset=utf-8;base64, ${java.base64Encode(htm)}`, 'æ›´æ–°ä¹¦æº')\n    return []\n}",
        "loginCheckJs": "var util = {}\n\nfunction objStringify(obj) {\n    return JSON.stringify(obj, (n, v) => {\n        if (typeof v == \"function\")\n            return v.toString();\n        return v;\n    });\n}\n\n// æ£€æµ‹ æºé˜…\n// å¯ç”¨ java.ajax() ä¸å¯ç”¨ java.webview() java.ajaxAll()\n// å¯ç”¨ java.getCookie() cache.put() cache.get() é»˜è®¤å€¼ä¸º undefined\n// å¯ç”¨ java.startBrowser() ä¸å¯ç”¨ java.startBrowserAwaitAwait\n// å¯ç”¨ source.bookSourceName source.getVariable() source.setVariable()ç­‰\n// java.getUserAgent() java.getWebViewUA() ç›®å‰è¿”å›å†…å®¹ç›¸åŒ\nfunction isSourceRead() {\n    return java.getUserAgent() === java.getWebViewUA()\n}\n// æ­£å¼ç‰ˆ ä¸æ”¯æŒåœ¨ JSlib çš„å‡½æ•°ç›´æ¥è®¾ç½®é»˜è®¤å‚æ•°\n// æ­£å¼ç‰ˆ ä¸æ”¯æŒ a?.b çš„å†™æ³•\n// æ£€æµ‹ é˜…è¯» æ­£å¼ç‰ˆ ä¸ Beta ç‰ˆæœ¬\nfunction isLegadoOfficial() {\n    let isLegadoOfficialStatus\n    try {\n        eval('({})?.value')\n        isLegadoOfficialStatus = false\n    } catch (e) {\n        isLegadoOfficialStatus = true\n    }\n    return isLegadoOfficialStatus\n}\n// æ£€æµ‹ é˜…è¯» Beta ç‰ˆæœ¬ ä¸ LYC ç‰ˆæœ¬\n// LYC ç‰ˆæœ¬æ–°å¢å‡½æ•°\n// java.ajaxTestAll()\n// java.openVideoPlayer(url: String, title: String, float: Boolean)\n// cookie.setWebCookie(url,cookie)\n// source.refreshExplore()\n// source.refreshJSLib()\nfunction isLegadoLYC() {\n    return typeof java.ajaxTestAll === \"function\"\n}\n\nfunction publicFunc() {\n    let u = {}, settings \n    // è¾“å‡ºä¹¦æºä¿¡æ¯\n    java.log(`${source.bookSourceComment.split(\"\\n\")[0]}`)\n    java.log(`ğŸ“Œ ${source.bookSourceComment.split(\"\\n\")[2]}`)\n    java.log(`ğŸ“† æ›´æ–°æ—¶é—´ï¼š${java.timeFormat(source.lastUpdateTime)}`)\n\n    if (isSourceRead()) {\n        java.log(\"ğŸ“± è½¯ä»¶å¹³å°ï¼šğŸ æºé˜… SourceRead\")\n    } else if (isLegadoOfficial()) {\n        java.log(\"ğŸ“± è½¯ä»¶å¹³å°ï¼šğŸ¤– é˜…è¯» æ­£å¼ç‰ˆ\")\n        sleepToast(\"\\nâš ï¸å½“å‰è½¯ä»¶ä¸ºï¼šé˜…è¯»ã€æ­£å¼ç‰ˆã€‘\\nã€æ­£å¼ç‰ˆã€‘å·²å¹´ä¹…å¤±ä¿®ï¼Œä¸æ¨èç»§ç»­ä½¿ç”¨\\n\\nä¸ºäº†æ›´å¥½çš„ä½¿ç”¨ä½“éªŒï¼Œè¯·ç”¨ï¼š\\nã€é˜…è¯» Plusã€‘æˆ–ã€é˜…è¯» Beta æ–°åŒ…åã€‘\\n\\nå³å°†ä¸ºæ‚¨æ‰“å¼€ã€é˜…è¯» Plusã€‘ä¸‹è½½ç•Œé¢\")\n        sleep(3); startBrowser(\"https://loyc.xyz/c/legado.html#download\", \"ä¸‹è½½é˜…è¯» Plus\")\n\n    } else {\n        if (isLegadoLYC()) {\n            java.log(\"ğŸ“± è½¯ä»¶å¹³å°ï¼šğŸ¤– é˜…è¯» Betaã€æ–°åŒ…åã€‘/ é˜…è¯» Plus\")\n        } else {\n            java.log(\"ğŸ“± è½¯ä»¶å¹³å°ï¼šğŸ¤– é˜…è¯» Betaã€åŸåŒ…åã€‘\")\n            sleepToast(\"\\nâš ï¸å½“å‰è½¯ä»¶ä¸ºï¼šé˜…è¯» Betaã€åŸåŒ…åã€‘\\n\\nä¸ºäº†æ›´å¥½çš„ä½¿ç”¨ä½“éªŒï¼Œè¯·ç”¨ï¼š\\nã€é˜…è¯» Plusã€‘æˆ–ã€é˜…è¯» Beta æ–°åŒ…åã€‘\\n\\nå³å°†ä¸ºæ‚¨æ‰“å¼€ã€é˜…è¯» Plusã€‘ä¸‹è½½ç•Œé¢\")\n            sleep(3); startBrowser(\"https://loyc.xyz/c/legado.html#download\", \"ä¸‹è½½é˜…è¯» Plus\")\n        }\n    }\n\n    // è®¾ç½®åˆå§‹åŒ–\n    // cache.delete(\"linpxSettings\")\n    settings = getFromCacheObject(\"linpxSettings\")\n    if (settings) {\n        java.log(\"âš™ï¸ ä½¿ç”¨è‡ªå®šä¹‰è®¾ç½®\")\n    } else {\n        java.log(\"âš™ï¸ ä½¿ç”¨é»˜è®¤è®¾ç½®\")\n        settings = setDefaultSettings()\n    }\n    u.settings = settings\n    putInCacheObject(\"linpxSettings\", settings)  // è®¾ç½®å†™å…¥ç¼“å­˜\n\n    u.environment = {}\n    u.environment.IS_SOURCEREAD = isSourceRead()\n    u.environment.IS_LEGADO = !isSourceRead()\n    u.environment.IS_LYC_BRUNCH = isLegadoLYC()\n    putInCacheObject(\"pixivEnvironment\", u.environment)  // è®¾ç½®å†™å…¥ç¼“å­˜\n\n    u.debugFunc = (func) => {\n        if (util.settings.DEBUG) {\n            func()\n        }\n    }\n\n    // å°†å¤šä¸ªé•¿ç¯‡å°è¯´è§£æä¸ºä¸€æœ¬ä¹¦\n    u.combineNovels = function(novels) {\n        return novels.filter(novel => {\n            // å•æœ¬ç›´æ¥è§£æä¸ºä¸€æœ¬ä¹¦ï¼Œéœ€è¦åˆ¤æ–­æ˜¯å¦ä¸º null\n            if (novel.seriesId === undefined || novel.seriesId === null) {\n                return true\n            }\n            //é›†åˆä¸­æ²¡æœ‰è¯¥ç³»åˆ—è§£æä¸ºä¸€æœ¬ä¹¦\n            if (!seriesSet.has(novel.seriesId)) {\n                seriesSet.add(novel.seriesId)\n                return true\n            }\n            return false\n        })\n    }\n\n    // å¤„ç† novels åˆ—è¡¨\n    u.handNovels = function (novels) {\n        novels.forEach(novel => {\n            if (!novel.id) novel.id = novel._id\n            // novel.title = novel.title\n            // novel.userName = novel.userName\n            // novel.tags = novel.tags\n            if (novel.tags === undefined) {\n                novel.tags = []\n            }\n            // å…¼å®¹è¯¦æƒ…é¡µ\n            if (novel.content) {\n                if (novel.series) {\n                    novel.seriesId = novel.series.id\n                    novel.seriesTitle = novel.series.title\n                }\n                novel.description = novel.desc\n                novel.textCount = novel.length = novel.content.length\n            }\n\n            if (!novel.seriesId) {\n                novel.tags.unshift(\"å•æœ¬\")\n                novel.textCount = novel.length\n                novel.latestChapter = novel.title\n                novel.description = novel.desc\n                // novel.coverUrl = novel.coverUrl\n                novel.detailedUrl = urlNovelDetailed(novel.id)\n            }\n\n            // ä¼˜åŒ– æœªç¼“å­˜ç³»åˆ—ç›®å½•çš„æƒ…å†µ\n            let series = getAjaxJson(urlSeriesDetailed(novel.seriesId))   // å…¼å®¹è¯¦æƒ…\n            if (novel.seriesId) {\n                novel.latestChapter = novel.title\n                novel.title = novel.seriesTitle\n                novel.tags.unshift(\"é•¿ç¯‡\")\n                // novel.createDate = novel.createDate\n                novel.description = novel.desc\n                novel.detailedUrl = urlNovelDetailed(novel.id)\n            }\n\n            if (novel.seriesId && !series.error) {\n                java.log(`æ­£åœ¨è·å–ç³»åˆ—å°è¯´ï¼š${novel.seriesId}`)\n                novel.id = series.novels[0].id\n                // novel.title = series.title\n                if (series.tags) {\n                    novel.tags = novel.tags.concat(series.tags)\n                }\n                novel.latestChapter = series.novels.reverse()[0].title\n                novel.description = series.caption\n                // åç«¯ç›®å‰æ²¡æœ‰ç³»åˆ—çš„ coverUrl å­—æ®µ\n                // novel.coverUrl = series.coverUrl\n                novel.coverUrl = series.novels[0].coverUrl\n\n                let firstNovel = getAjaxJson(urlNovelDetailed(novel.id))\n                if (firstNovel.error !== true) {\n                    novel.tags = novel.tags.concat(firstNovel.tags)\n                    novel.createDate = firstNovel.createDate\n                    if (novel.description === \"\") {\n                        novel.description = firstNovel.desc\n                    }\n                }\n            }\n        })\n        return novels\n    }\n\n    // å°è¯´ä¿¡æ¯æ ¼å¼åŒ–\n    u.formatNovels = function (novels) {\n        novels.forEach(novel => {\n            novel.title = novel.title.trim()\n            if (!novel.userName.startsWith(\"@\")) novel.userName = `@${novel.userName}`\n            novel.coverUrl = urlCoverUrl(novel.coverUrl)\n            novel.createDate = dateFormat(novel.createDate)\n\n            novel.tags2 = []\n            for (let i in novel.tags) {\n                let tag = novel.tags[i]\n                if (tag.includes(\"/\")) {\n                    let tags = tag.split(\"/\")\n                    novel.tags2 = novel.tags2.concat(tags)\n                } else {\n                    novel.tags2.push(tag)\n                }\n            }\n            novel.tags = Array.from(new Set(novel.tags2))\n            novel.tags = novel.tags.join(\",\")\n\n            if (util.settings.MORE_INFORMATION) {\n                novel.description = `\\nä¹¦åï¼š${novel.title}\\nä½œè€…ï¼š${novel.userName}\\næ ‡ç­¾ï¼š${novel.tags}\\nä¸Šä¼ ï¼š${novel.createDate}\\nç®€ä»‹ï¼š${novel.description}`\n            } else {\n                novel.description = `\\n${novel.description}\\nä¸Šä¼ æ—¶é—´ï¼š${novel.createDate}`\n            }\n        })\n        return novels\n    }\n\n    // ä»ç½‘å€è·å–idï¼Œè¿”å›å•ç¯‡å°è¯´ res\n    u.getNovelRes = function (novel) {\n        let novelId = 0, res = []\n        let isJson = isJsonString(result)\n        let isHtml = isHtmlString(result)\n        if (!isJson && isHtml) {\n            let id = baseUrl.match(new RegExp(\"\\\\d+\"))[0]\n            let pattern = \"(https?://)?(api\\\\.|www\\\\.)?(furrynovel\\\\.(ink|xyz))/pixiv/user/\\\\d+(/cache)?\"\n            let isAuthor = baseUrl.match(new RegExp(pattern))\n            if (isAuthor) {\n                java.log(`ä½œè€…IDï¼š${id}`)\n                novelId = getAjaxJson(urlUserDetailed(id)).novels.reverse()[0]\n                java.log(`æœ€æ–°ä¸€ç¯‡å°è¯´IDï¼š${novelId}`)\n            }\n\n            pattern = \"(https?://)?(api\\\\.|www\\\\.)?(furrynovel\\\\.(ink|xyz))/(pn|pixiv/novel)/\\\\d+(/cache)?\"\n            let isNovel = baseUrl.match(new RegExp(pattern))\n            if (isNovel) {\n                novelId = id\n                java.log(`åŒ¹é…å°è¯´IDï¼š${id}`)\n            }\n            res = getAjaxJson(urlNovelDetailed(novelId))\n        }\n\n        if (isJson) {\n            res = JSON.parse(result)\n        }\n        if (res.error) {\n            java.log(`æ— æ³•ä» Linpx è·å–å½“å‰å°è¯´`)\n            java.log(JSON.stringify(res))\n        }\n        return res\n    }\n\n    util = u\n    java.put(\"util\", objStringify(u))\n}\n\npublicFunc()\nif (result.code() === 200) getWebViewUA()\njava.getStrResponse(null, null)",
        "loginUi": "@js:\nlet source = [\n    {\"ğŸ†™ æ›´æ–°ä¹¦æº\": \"updateSource()\" },\n    {\"ğŸ”° ä½¿ç”¨æŒ‡å—\": \"startGithubReadme()\" },\n    {\"ğŸ åé¦ˆé—®é¢˜\": \"startGithubIssue()\" },\n]\n\nlet novel = [\n    {\"ç« èŠ‚åç§°\": \"text\" },\n    {\"â¤´ï¸ åˆ†äº«ç« èŠ‚\": \"shareFactory('novel')\" },\n    {\"â¤´ï¸ åˆ†äº«ä½œè€…\": \"shareFactory('author')\" },\n    {\"ğŸ…¿ï¸ åˆ†äº«å°è¯´\": \"shareFactory('pixiv')\" },\n]\n\nlet settings = [\n    {\"ä¹¦æºè®¾ç½®\": \"text\" },\n    {\"âš™ï¸ å½“å‰è®¾ç½®\": \"showSettings()\" },\n    {\"ğŸ”§ é»˜è®¤è®¾ç½®\": \"setDefaultSettingsLoginUrl()\" },\n    {\"ğŸ‘¤ ğŸš« æœç´¢ä½œè€…\": \"editSettings('SEARCH_AUTHOR')\" },\n\n    {\"ğŸ€„ ğŸš« ç¹ç®€é€šæœ\": \"editSettings('CONVERT_CHINESE')\" },\n    {\"ğŸš« ğŸ“– æ›´å¤šç®€ä»‹\": \"editSettings('MORE_INFORMATION')\" },\n    {\"ğŸ”— ğŸš« åŸå§‹é“¾æ¥\": \"editSettings('SHOW_ORIGINAL_LINK')\" },\n\n    {\"ğŸ“š ğŸš« æ¢å¤ã€Šã€‹\": \"editSettings('REPLACE_TITLE_MARKS')\" },\n    {\"ğŸ–¼ï¸ ğŸš« æ˜¾ç¤ºæè¿°\": \"editSettings('SHOW_CAPTIONS')\" },\n    {\"ğŸ ğŸš« è°ƒè¯•æ¨¡å¼\": \"editSettings('DEBUG')\" },\n]\n\n// æ·»åŠ æŒ‰é’®\nlet li = source\ntry {\n    if (book) li = li.concat(novel)\n} catch (e) {}\nli = li.concat(settings)\n\n// å¤„ç†æŒ‰é’®\nli.forEach(item => {\n    item.name = Object.keys(item)[0]\n    let list = item.name.split(\" \")\n    if (list.length === 1 ) {\n        item.type = \"text\"\n    } else if (list.length === 2) {\n        item.type = \"button\"\n        item.action = Object.values(item)[0]\n    } else {\n        item.name = list[list.length - 1]\n        item.type = \"toggle\"\n        item.default = `${list[0]} `\n        list.length = list.length - 1\n        item.chars = list.map(char => `${char} `)\n        item.action = Object.values(item)[0]\n    }\n    delete item[Object.keys(item)[0]]\n    // æ·»åŠ æ ¼å¼\n    if (item.type === \"button\" || item.type === \"toggle\") {\n        item.style = {}\n        item.style.layout_flexGrow = 1\n        item.style.layout_flexBasisPercent = -1\n    }\n})\n\nJSON.stringify(li)",
        "loginUrl": "function login() {}\n\nfunction getNovel() {\n    let novel = {}\n    novel.id = chapter.url.match(/\\d+/)[0]\n    novel.title = chapter.title\n    novel.userName = book.author.replace(\"@\", \"\")\n    if (book.tocUrl.includes(\"series\")) {\n        novel.seriesId = book.tocUrl.match(/\\d+/)[0]\n        novel.seriesTitle = book.name\n    } else {\n        novel.seriesId = 0\n        novel.seriesTitle = \"\"\n    }\n\n    let resp = getAjaxJson(urlNovelDetailed(novel.id))\n    novel.userId = resp.userId\n    if (!novel.seriesId && resp.series) {\n        novel.seriesId = resp.series.id\n        novel.seriesTitle = resp.series.title\n    }\n    return novel\n}\n\nfunction shareFactory(type) {\n    let novel = getNovel()\n    if (!novel) return sleepToast(\"ğŸ”° åŠŸèƒ½æç¤º\\n\\nâš ï¸ è¯·åœ¨å°è¯´é˜…è¯»é¡µé¢ï¼Œä½¿ç”¨æœ¬åŠŸèƒ½\")\n    if (type.includes(\"author\")) {\n        sleepToast(\"\\n\\nå·²å¤åˆ¶å½“å‰ä½œè€…é“¾æ¥\", 1)\n        java.copyText(urlUserUrl(novel.userId))\n        // startBrowser(urlUserUrl(novel.userId), novel.userName)\n    }\n    else if (type.includes(\"novel\")) {\n        sleepToast(\"\\n\\nå·²å¤åˆ¶å½“å‰å°è¯´é“¾æ¥\", 1)\n        java.copyText(urlNovelUrl(novel.id))\n        // startBrowser(urlNovelUrl(novel.id), novel.title)\n    }\n    else if (type.includes(\"pixiv\") && !novel.seriesId) {\n        sleepToast(\"\\n\\nå·²å¤åˆ¶å½“å‰å°è¯´ç³»åˆ— Pixiv é“¾æ¥\", 1)\n        java.copyText(urlSourceUrl(novel.id))\n        // startBrowser(urlSourceUrl(novel.id), novel.title)\n    }\n    else if (type.includes(\"pixiv\") && novel.seriesId) {\n        sleepToast(\"\\n\\nå·²å¤åˆ¶å½“å‰å°è¯´ç³»åˆ— Pixiv é“¾æ¥\", 1)\n        java.copyText(urlSeriesUrl(novel.seriesId))\n        // startBrowser(urlSeriesUrl(novel.seriesId), novel.seriesTitle)\n    }\n}\n\nfunction startGithubReadme() {\n    startBrowser(\"https://pixivsource.pages.dev/Linpx\", \"ä½¿ç”¨æŒ‡å—\")\n}\nfunction startGithubIssue() {\n    startBrowser(\"https://github.com/DowneyRem/PixivSource/issues\", \"åé¦ˆé—®é¢˜\")\n}\n\nfunction checkStatus(status) {\n    if (eval(String(status)) === true) return \"â¤ï¸\"\n    else return \"ğŸ–¤\"\n}\n\nlet settingsName = {\n    \"SEARCH_AUTHOR\": \"ğŸ” æœç´¢ä½œè€…\",\n    \"CONVERT_CHINESE\": \"ğŸ€„ï¸ ç¹ç®€é€šæœ\",\n    \"MORE_INFORMATION\": \"ğŸ“– æ›´å¤šç®€ä»‹\",\n    \"SHOW_ORIGINAL_LINK\": \"ğŸ”— åŸå§‹é“¾æ¥\",\n    \"REPLACE_TITLE_MARKS\": \"ğŸ“š æ¢å¤ã€Šã€‹\",\n    \"SHOW_CAPTIONS\": \"ğŸ–¼ï¸ æ˜¾ç¤ºæè¿°\",\n    \"DEBUG\": \"ğŸ è°ƒè¯•æ¨¡å¼\",\n}\n\nfunction statusMsg(status) {\n    if (status === true) return \"âœ… å·²å¼€å¯\"\n    else if (status === false) return \"ğŸš« å·²å…³é—­\"\n    else return \"ğŸˆšï¸ æœªè®¾ç½®\"\n}\n\n// æ£€æµ‹å¿«é€Ÿæ¨¡å¼ä¿®æ”¹çš„4ä¸ªè®¾ç½®\nfunction getSettingStatus(mode) {\n    if (mode === undefined) mode = \"\"\n    let keys = [], msgList = []\n    let settings = getFromCacheObject(\"linpxSettings\")\n    keys = Object.keys(settingsName)\n    for (let i in keys) {\n        msgList.push(`${statusMsg(settings[keys[i]])}ã€€${settingsName[keys[i]]}`)\n    }\n    return msgList.join(\"\\n\").trim()\n}\n\nfunction showSettings() {\n    sleepToast(`\\nâš™ï¸ å½“å‰è®¾ç½®\\n\\n${getSettingStatus()}`)\n}\n\nfunction setDefaultSettingsLoginUrl() {\n    setDefaultSettings()\n    sleepToast(`\\nâœ… å·²æ¢å¤ã€€ğŸ”§ é»˜è®¤è®¾ç½®\\n\\n${getSettingStatus()}`)\n}\n\nfunction editSettings(settingName) {\n    let msg, status\n    let settings = getFromCacheObject(\"linpxSettings\")\n    if (!settings) settings = setDefaultSettings()\n    if (!!settings[settingName]) {\n        status = settings[settingName] = !settings[settingName]\n    } else {\n        status = settings[settingName] = true\n    }\n    putInCacheObject(\"linpxSettings\", settings)\n    msg = `\\n\\n${statusMsg(status)}ã€€${settingsName[settingName]}`\n    sleepToast(msg)\n}",
        "respondTime": 180000,
        "ruleBookInfo": {
            "author": "userName",
            "canReName": "true",
            "coverUrl": "coverUrl",
            "init": "@js:\nvar util = objParse(String(java.get(\"util\")))\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\nfunction novelHandler(novel) {\n    novel = util.formatNovels(util.handNovels([novel]))[0]\n    // ä¼˜åŒ– æœªç¼“å­˜ç³»åˆ—ç›®å½•çš„æƒ…å†µï¼šç›®å½•é“¾æ¥è®¾ç½®ä¸ºå•ç¯‡é“¾æ¥\n    let result = getAjaxJson(urlSeriesDetailed(novel.seriesId))\n    if (!novel.seriesId || novel.seriesId && result.error) {\n        book.bookUrl = novel.detailedUrl = urlNovelUrl(novel.id)\n        book.tocUrl = novel.catalogUrl = urlNovelDetailed(novel.id)\n    } else {\n        book.bookUrl = novel.detailedUrl = urlNovelUrl(novel.id)\n        book.tocUrl = novel.catalogUrl = urlSeriesDetailed(novel.seriesId)\n    }\n    return novel\n}\n\n(() => {\n    return novelHandler(util.getNovelRes(result))\n})();",
            "intro": "description",
            "kind": "tags",
            "lastChapter": "latestChapter",
            "name": "title",
            "tocUrl": "catalogUrl",
            "wordCount": "textCount"
        },
        "ruleContent": {
            "content": "@js:\nvar util = objParse(String(java.get(\"util\")))\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\nfunction replaceUploadedImage(res, content) {\n    // è·å– [uploadedimage:] çš„å›¾ç‰‡é“¾æ¥\n    if (res.images !== undefined && res.images !== null) {\n        Object.keys(res.images).forEach((key) => {\n            // content = content.replace(`[uploadedimage:${key}]`, `<img src=\"${urlCoverUrl(res.images[key].origin)}\">`)\n            content = content.replace(`[uploadedimage:${key}]`, `<img src=\"${urlPixivCoverUrl(res.images[key].origin)}\">`)\n        })\n    }\n    return content\n}\nfunction replacePixivImage(content) {\n    // è·å– [pixivimage:] çš„å›¾ç‰‡é“¾æ¥ [pixivimage:1234] [pixivimage:1234-1]\n    let matched = content.match(RegExp(/\\[pixivimage:(\\d+)-?(\\d+)]/gm))\n    if (matched) {\n        matched.forEach(pixivimage => {\n            let matched2, illustId, order = 0\n            if (pixivimage.includes(\"-\")) {\n                matched2 = pixivimage.match(RegExp(\"(\\\\d+)-(\\\\d+)\"))\n                illustId = matched2[1]; order = matched2[2]\n            } else {\n                matched2 = pixivimage.match(RegExp(\"\\\\d+\"))\n                illustId = matched2[0];\n            }\n            if (urlIllustOriginal(illustId, order)) {\n                content = content.replace(`${pixivimage}`, `<img src=\"${urlIllustOriginal(illustId, order)}\">`)\n            } else {\n                content = content.replace(`${pixivimage}`, ``)\n            }\n        })\n    }\n    return content\n}\nfunction replaceNewPage(content) {\n    // æ›¿æ¢ Pixiv åˆ†é¡µæ ‡è®°ç¬¦å· [newpage]\n    if (!util.environment.IS_LYC_BRUNCH) {\n        let matched = content.match(RegExp(/[ ã€€]*\\[newpage][ ã€€]*/gm))\n        if (matched) {\n            for (let i in matched) {\n                content = content.replace(`${matched[i]}`, `${\"<p>â€‹<p/>\".repeat(3)}`)\n            }\n        }\n    }\n    return content\n}\nfunction replaceChapter(content) {\n    // æ›¿æ¢ Pixiv ç« èŠ‚æ ‡è®°ç¬¦å· [chapter:]\n    let matched = content.match(RegExp(/\\[chapter:(.*?)]/gm))\n    if (matched) {\n        for (let i in matched) {\n            let matched2 = matched[i].match(/\\[chapter:(.*?)]/m)\n            let chapter = matched2[1].trim()\n            // æ›¿æ¢ Pixiv åˆ†é¡µæ ‡è®°ç¬¦å· [newpage]\n            if (util.environment.IS_LYC_BRUNCH) {\n                content = content.replace(`${matched[i]}`, `<usehtml><h3>${chapter}</h3></usehtml>`)\n            } else {\n                content = content.replace(`${matched[i]}`, `${chapter}<p>â€‹<p/>`)\n            }\n        }\n    }\n    return content\n}\nfunction replaceJumpPage(content) {\n    // æ›¿æ¢ Pixiv è·³è½¬é¡µé¢æ ‡è®°ç¬¦å· [[jump:]]\n    let matched = content.match(RegExp(/\\[jump:(\\d+)]/gm))\n    if (matched) {\n        for (let i in matched) {\n            let page = matched[i].match(/\\d+/)\n            content = content.replace(`${matched[i]}`, `\\n\\nè·³è½¬è‡³ç¬¬${page}èŠ‚`)\n        }\n    }\n    return content\n}\nfunction replaceJumpUrl(content) {\n    // æ›¿æ¢ Pixiv é“¾æ¥æ ‡è®°ç¬¦å· [[jumpuri: > ]]\n    let matched = content.match(RegExp(/\\[\\[jumpuri:(.*?)>(.*?)]]/gm))\n    if (matched) {\n        for (let i in matched) {\n            let matched2 = matched[i].match(/\\[\\[jumpuri:(.*?)>(.*?)]]/m)\n            let matchedText = matched2[0]\n            let urlName = matched2[1].trim()\n            let urlLink = matched2[2].trim()\n\n            if (util.environment.IS_LYC_BRUNCH) {\n                content = content.replace(`${matchedText}`, `<usehtml><p>ã€€ã€€<a href=${urlLink}>${urlName}</a></p></usehtml>`)\n            } else {\n                if (urlLink === urlName) {\n                    content = content.replace(`${matchedText}`, `${urlName}`)\n                } else {\n                    content = content.replace(`${matchedText}`, `${urlName}: ${urlLink}`)\n                }\n            }\n        }\n    }\n    return content\n}\nfunction replaceRb(content) {\n    // æ›¿æ¢ Pixiv æ³¨éŸ³æ ‡è®°ç¬¦å· [[rb: > ]]\n    let matched = content.match(RegExp(/\\[\\[rb:(.*?)>(.*?)]]/gm))\n    if (matched) {\n        for (let i in matched) {\n            let matched2 = matched[i].match(/\\[\\[rb:(.*?)>(.*?)]]/m)\n            let matchedText = matched2[0]\n            let kanji = matched2[1].trim()\n            let kana = matched2[2].trim()\n\n            if (!util.settings.REPLACE_TITLE_MARKS) {\n                // é»˜è®¤æ›¿æ¢æˆï¼ˆæ‹¬å·ï¼‰\n                content = content.replace(`${matchedText}`, `${kanji}ï¼ˆ${kana}ï¼‰`)\n            } else {\n                let reg = RegExp(\"[\\\\u4E00-\\\\u9FFF]+\", \"g\");\n                if (reg.test(kana)) {\n                    // kanaä¸ºä¸­æ–‡ï¼Œåˆ™æ›¿æ¢å›ã€Šä¹¦åå·ã€‹\n                    content = content.replace(`${matchedText}`, `${kanji}ã€Š${kana}ã€‹`)\n                } else {\n                    // é˜…è¯»ä¸æ”¯æŒ <ruby> <rt> æ³¨éŸ³\n                    // content = content.replace(`${matchedText}`, `<ruby>${kanji}<rt>${kana}</rt></ruby>`)\n                    content = content.replace(`${matchedText}`, `${kanji}ï¼ˆ${kana}ï¼‰`)\n                }\n            }\n        }\n    }\n    return content\n}\n\nfunction getContent(res) {\n    let content = res.content\n    if (util.settings.SHOW_CAPTIONS === true && res.desc !== \"\") {\n        content = res.desc + \"\\n\" + \"â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\\n\".repeat(2) + content\n    }\n\n    // æ›¿æ¢ Pixiv æ ‡è®°ç¬¦\n    content = replaceUploadedImage(res, content)\n    content = replacePixivImage(content)\n    content = replaceNewPage(content)\n    content = replaceChapter(content)\n    content = replaceJumpPage(content)\n    content = replaceJumpUrl(content)\n    content = replaceRb(content)\n    return content\n}\n\n(() => {\n    return getContent(util.getNovelRes(result))\n})()",
            "imageStyle": "FULL",
            "callBackJs": "function shareBook() {\n    let text = `æˆ‘æ­£åœ¨çœ‹ï¼šã€${book.author.replace(\"@\", \"\")}ã€‘åˆ›ä½œçš„ã€Š${book.name}ã€‹`\n    if (!!book.durChapterTitle && String(book.name) !== String(book.durChapterTitle)) {\n        text += `çš„ ã€${book.durChapterTitle}ã€‘`\n    }\n    text += `\\n\\nå°è¯´é“¾æ¥ï¼š\\n${book.bookUrl}\\n\\nåˆ†äº«è‡ªã€å¼€æºé˜…è¯»ã€‘Linpxä¹¦æºã€‚ä½¿ç”¨æ·»åŠ ç½‘å€ï¼Œå¿«é€Ÿæ·»åŠ æœ¬æ–‡`\n    java.copyText(text)\n    return true\n}\n\nfunction clearCache() {\n    let novel = getNovel()\n    cache.delete(urlNovelDetailed(novel.id))\n    if (novel.seriesId) cache.delete(urlSeriesDetailed(novel.seriesId))\n    return true\n}\n\nfunction copyBookUrl() {\n    java.copyText(book.bookUrl)\n    return true\n}\ncopyTocUrl = copyBookUrl\n\n// ä¿å­˜é˜…è¯»ï¼Œæ›´æ–°ç™»å½•ç•Œé¢çš„ç« èŠ‚åç§°\nfunction saveRead() {\n    source.putLoginInfo(JSON.stringify({\"ç« èŠ‚åç§°\": book.durChapterTitle}))\n}\n\nfunction startShelfRefresh() {\n    source.putConcurrent(\"18/30000\")\n}\n\nfunction endShelfRefresh() {\n    source.putConcurrent(\"25/5000\")\n}\n\nfunction callBackFactory(event) {\n    switch (event) {\n        // case \"clickBookName\":\n        //     return clickBookName()\n        // case \"longClickBookName\":\n        //     return longClickBookName()\n        // case \"clickAuthor\":\n        //     return clickAuthor()\n        // case \"longClickAuthor\":\n        //     return longClickAuthor()\n        // case \"clickCustomButton\":\n        //     return customButton()\n        // case \"longClickCustomButton\":\n        //     return longcustomButton()\n\n        case \"clickShareBook\":\n            return shareBook()\n        case \"clickClearCache\":\n            return clearCache()\n        case \"clickCopyBookUrl\":\n            return copyBookUrl()\n        case \"clickCopyTocUrl\":\n            return copyTocUrl()\n\n        // ä¸‹é¢çš„äº‹ä»¶æ— æ³•è¢«å›è°ƒç»“æœæ¶ˆè´¹\n        // case \"addBookShelf\":\n        //     return addBookShelf()\n        // case \"delBookShelf\":\n        //     return delBookShelf()\n        case \"saveRead\":\n            return saveRead()\n        // case \"startRead\":\n        //     return startRead()\n        // case \"endRead\":\n        //     return endRead()\n        case \"startShelfRefresh\":\n            return startShelfRefresh()\n        case \"endShelfRefresh\":\n            return endShelfRefresh()\n    }\n}\n\n(() => {\n    return callBackFactory(event)\n})()"
        },
        "ruleExplore": {
            "author": "userName",
            "bookList": "@js:\nvar util = objParse(String(java.get(\"util\")))\nvar seriesSet = new Set();  // å­˜å‚¨seriesID\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\n/**\n * @params arr ä¼ å…¥çš„æºæ•°ç»„\n * @params length éœ€è¦è·å–çš„å…ƒç´ çš„ä¸ªæ•°\n */\nfunction randomChoseArrayItem(arr, length) {\n    let copyArr = JSON.parse(JSON.stringify(arr))\n    let newArr = [];\n    for (let i = 0; i < length; i++) {\n        let index = Math.floor(Math.random() * copyArr.length);\n        let item = copyArr[index];\n        newArr.push(item)\n        copyArr.splice(index, 1)\n    }\n    return newArr.reverse()\n}\n\n\nfunction handlerRecommendUsers() {\n    const MAX_FETCH_USER_NUMBER = 2;\n\n    return () => {\n        let userIds = JSON.parse(result).map(i => i.id)\n        // java.log(`ç”¨æˆ·idä¸ªæ•°:${userIds.length}`)\n        if (userIds.length > MAX_FETCH_USER_NUMBER) {\n            userIds = randomChoseArrayItem(userIds, MAX_FETCH_USER_NUMBER);\n        }\n        // java.log(`æŸ¥è¯¢çš„ç”¨æˆ·Ids:${userIds}`)\n        let usersInfo = getWebviewJson(urlUsersDetailed(userIds))\n        // java.log(`è¿”å›çš„${JSON.stringify(usersInfo)}`)\n        let queryNovelIds = []\n        // java.log(`${JSON.stringify(usersInfo)}`)\n        usersInfo.filter(user => user.novels && user.novels.length > 0)\n            .map(user => user.novels)\n            // å°†listå±•å¹³[1,2,3]å˜ä¸º1,2,3 æ·»åŠ åˆ°novelListä¸­\n            .forEach(novels => {\n                novels.forEach(novel => {\n                    queryNovelIds.push(novel)\n                })\n            })\n        // æš‚æ—¶é™åˆ¶æœ€å¤§è·å–æ•°é‡\n        if (queryNovelIds.length > 10) {\n            queryNovelIds = randomChoseArrayItem(queryNovelIds, 10)\n        }\n        novelList = getWebviewJson(urlNovelsDetailed(queryNovelIds))\n        return util.formatNovels(util.handNovels(util.combineNovels(novelList)))\n    }\n}\n\nfunction handlerFollowLatest() {\n    return () => {\n        let resp = JSON.parse(result)\n        return util.formatNovels(util.handNovels(util.combineNovels(resp)))\n    }\n}\n\nfunction handlerRegexNovels() {\n    return () => {\n        let result = java.webView(null, \"https://furrynovel.ink\", null)\n        let name = result.match(RegExp('<div class=\" font-bold text-xl line-clamp-1\">(.*?)</div>'))[1]\n        let resp = getAjaxJson(urlSearchNovel(name))\n        if (resp.total !== undefined) {\n            return util.formatNovels(util.handNovels(util.combineNovels(resp.novels)))\n        }\n        return []\n    }\n}\n\nfunction handlerFactory() {\n    if (baseUrl.includes(\"https://cdn.jsdelivr.net\")) {\n        return () => {updateSource(); return []}\n    }\n    if (baseUrl.includes(\"/fav/user\")) {\n        return handlerRecommendUsers()\n    }\n    if (baseUrl.includes(\"/pixiv/novels/recent\")) {\n        return handlerFollowLatest()\n    }\n    if (baseUrl.includes(\"https://furrynovel.ink\")) {\n        return handlerRegexNovels()\n    }\n    else {\n        return () => {startBrowser(baseUrl, \"\"); return []}\n    }\n}\n\n(() => {\n    return handlerFactory()()\n})()",
            "bookUrl": "detailedUrl",
            "coverUrl": "coverUrl",
            "intro": "description",
            "kind": "tags",
            "lastChapter": "latestChapter",
            "name": "title",
            "wordCount": "textCount"
        },
        "ruleSearch": {
            "author": "userName",
            "bookList": "@js:\nvar util = objParse(String(java.get(\"util\")))\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\n// å­˜å‚¨seriesID\nvar first = true;\nvar seriesSet = {\n    keywords: \"Linpx:Search\",\n    has: (value) => {\n        let page = Number(java.get(\"page\"))\n        if (page === 1 && first) {\n            first = false\n            cache.deleteMemory(this.keywords)\n            return false\n        }\n\n        let v = cache.getFromMemory(this.keywords)\n        if (v === undefined || v === null) {\n            return false\n        }\n        let set = new Set(JSON.parse(v))\n        return set.has(value)\n    },\n\n    add: (value) => {\n        let v = cache.getFromMemory(this.keywords)\n        if (v === undefined || v === null) {\n            cache.putMemory(this.keywords, JSON.stringify([value]))\n\n        } else {\n            let arr = JSON.parse(v)\n            if (typeof arr === \"string\") {\n                arr = Array(arr)\n            }\n            arr.push(value)\n            cache.putMemory(this.keywords, JSON.stringify(arr))\n        }\n    },\n};\n\nfunction getUser(username, exactMatch) {\n    let resp = getAjaxJson(urlSearchUsers(String(username)))\n    java.log(urlSearchUsers(String(username)))\n    // java.log(JSON.stringify(resp))\n    if (resp.error || resp.total === 0) {\n        return []\n    }\n\n    // å»é™¤æ— å°è¯´ä½œè€…\n    resp.users = resp.users.filter(user => user.novels.length >= 1)\n    // java.log(JSON.stringify(resp))\n    if (resp.total > resp.users.length) {\n        java.log(`å·²ç»å»é™¤ ${resp.total - resp.users.length} ä½æ— å°è¯´çš„ä½œè€…`)\n    }\n    if (resp.users.length === 0) {\n        return []\n    }\n\n    if (!exactMatch) {\n        return resp.users\n    }\n    // åªè¿”å›ç”¨æˆ·åå®Œå…¨ä¸€æ ·çš„ç”¨æˆ·\n    return resp.users.filter(user => {\n        return user.name === username\n    })\n}\n\nfunction getUserNovels(nidList) {\n    let page = Number(java.get(\"page\"))\n    // åˆ†é¡µ\n    let list = nidList.slice((page - 1) * 20, page * 20)\n    if (list.length === 0) {\n        return []\n    }\n    // java.log(`NIDURL:${urlNovelsDetailed(list)}`)\n    return getWebviewJson(urlNovelsDetailed(list))\n}\n\nfunction findUserNovels() {\n    let novelList = []\n    let username = String(java.get(\"key\"))\n    let userArr = getUser(username, false)\n    // è·å–ç”¨æˆ·æ‰€æœ‰å°è¯´\n    let uidList = userArr.filter(user => {\n        return user.novels.length > 0\n    }).map(user => user.id)\n    // java.log(JSON.stringify(uidList))\n\n    if (uidList.length > 0) {\n        let list = getWebviewJson(urlUsersDetailed(uidList))  // åŒ…å«æ‰€æœ‰å°è¯´æ•°æ®\n        // java.log(JSON.stringify(list))\n        let nidList = []\n        // ä»ä¸¤å±‚æ•°ç»„ä¸­æå–novelsId\n        list.forEach(user => {\n            // æŒ‰idé™åºæ’åº-ç›¸å½“äºæŒ‰æ—¶é—´é™åºæ’åº\n            user.novels.reverse().forEach(nid => nidList.push(nid))\n            // ä¼˜åŒ– æœªç¼“å­˜ç³»åˆ—ç›®å½•çš„æƒ…å†µï¼šseries æ•°æ®å†™å…¥ç¼“å­˜\n            user.series.forEach(series => {\n                series.novels = []\n                putInCacheObject(`LSeries${series.id}`, series)\n            })\n        })\n        // java.log(JSON.stringify(nidList))\n        getUserNovels(nidList).forEach(novel => {\n            novelList.push(novel)\n        })\n    }\n\n    // ä¼˜åŒ– æœªç¼“å­˜ç³»åˆ—ç›®å½•çš„æƒ…å†µï¼šseries æ•°æ®å†™å…¥ç¼“å­˜\n    novelList.forEach(novel =>{\n        if (novel.seriesId) {\n            let series = getFromCacheObject(`LSeries${novel.seriesId}`)\n            series.novels.push(novel)\n            putInCacheObject(`LSeries${novel.seriesId}`, series)\n        }\n    })\n    return novelList.reverse()  // æ–°å°è¯´å‰ç½®\n}\n\nfunction getNovels() {\n    if (result.startsWith(\"<!DOCTYPE html>\") || JSON.parse(result).error) {\n        return []\n    } else {\n        return JSON.parse(result).novels\n    }\n}\n\nfunction search(name, page=1) {\n    let resp = getAjaxJson(urlSearchNovel(name, page))\n    java.log(urlSearchNovel(name, page))\n    if (resp.error === undefined && resp.total > 0) {\n        return resp.novels\n    } else {\n        return []\n    }\n}\n\nfunction getConvertNovels() {\n    let novels = []\n    let novelName = String(java.get(\"key\"))\n    let name1 = String(java.s2t(novelName))\n    let name2 = String(java.t2s(novelName))\n    if (name1 !== novelName) novels = novels.concat(search(name1))\n    if (name2 !== novelName) novels = novels.concat(search(name2))\n    return novels\n}\n\n(() => {\n    let novels = []\n    let key = String(java.get(\"key\"))\n    if (key.startsWith(\"@\")) {\n        java.put(\"key\", key.slice(1))\n        novels = novels.concat(findUserNovels())\n    } else if (key.startsWith(\"#\")) {\n        java.put(\"key\", key.slice(1))\n        novels = novels.concat(getNovels())\n        // if (util.settings.CONVERT_CHINESE) novels = novels.concat(getConvertNovels())\n    } else {\n        novels = novels.concat(getNovels())\n        if (util.settings.SEARCH_AUTHOR) novels = novels.concat(findUserNovels())\n        if (util.settings.CONVERT_CHINESE) novels = novels.concat(getConvertNovels())\n    }\n    // java.log(JSON.stringify(novels))\n    // è¿”å›ç©ºåˆ—è¡¨ä¸­æ­¢æµç¨‹\n    if (novels.length === 0) {\n        return []\n    }\n    return util.formatNovels(util.handNovels(util.combineNovels(novels)))\n})()",
            "bookUrl": "detailedUrl",
            "checkKeyWord": "#æµ‹è¯•é¡µé¢",
            "coverUrl": "coverUrl",
            "intro": "description",
            "kind": "tags",
            "lastChapter": "latestChapter",
            "name": "title",
            "wordCount": "textCount"
        },
        "ruleToc": {
            "chapterList": "@js:\nvar util = objParse(String(java.get(\"util\")))\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\nfunction urlNovel(novelId) {\n    if (util.settings.SHOW_ORIGINAL_LINK) {\n        return urlNovelUrl(novelId)\n    } else {\n        return urlNovelDetailed(novelId)\n    }\n}\n\nfunction oneShotHandler(resp) {\n    resp.textCount =ã€€resp.content.length\n    resp.updateDate = timeTextFormat(resp.createDate)\n    return [{\n        title: resp.title.trim(),\n        chapterUrl: urlNovel(resp.id),\n        chapterInfo:`${resp.updateDate}ã€€ã€€${resp.textCount}å­—`\n    }]\n}\n\nfunction seriesHandler(resp) {\n    resp.novels.forEach(novel => {\n        novel.title = novel.title.trim()\n        novel.chapterUrl = urlNovel(novel.id)\n        // novel.updateDate = String(novel.coverUrl.match(RegExp(\"\\\\d{4}/\\\\d{2}/\\\\d{2}\")))  //fake\n        novel.detail = getAjaxJson(urlNovelDetailed(novel.id))\n        novel.textCount = novel.detail.content.length\n        novel.updateDate = timeTextFormat(novel.detail.createDate)\n        novel.chapterInfo = `${novel.updateDate}ã€€ã€€${novel.textCount}å­—`\n        delete novel.detail\n    })\n    return resp.novels\n}\n\n// ä¼˜åŒ– æœªç¼“å­˜ç³»åˆ—ç›®å½•çš„æƒ…å†µï¼šä»ç« èŠ‚æ•°æ®ä¸­ï¼Œè·å–ç³»åˆ—ç›®å½•\nfunction seriesContentHandler(resp) {\n    let novels = [], prevNovels = [], nextNovels = []\n    while (resp.series.prev !== null && resp.series.prev !== undefined) {\n        prevNovels.push(resp.series.prev)\n        resp = getAjaxJson(urlNovelDetailed(resp.series.prev.id))\n    }\n    nextNovels.push({id: resp.id, order: resp.series.order, title: resp.title})\n    while (resp.series.next !== null && resp.series.prev !== undefined) {\n        nextNovels.push(resp.series.next)\n        resp = getAjaxJson(urlNovelDetailed(resp.series.next.id))\n    }\n    novels = novels.concat(prevNovels.reverse())\n    novels = novels.concat(nextNovels)\n    novels.forEach(novel => {\n        novel.title = novel.title.trim()\n        novel.chapterUrl = urlNovel(novel.id)\n        novel.detail = getAjaxJson(urlNovelDetailed(novel.id))\n        novel.textCount = novel.detail.content.length\n        novel.updateDate = timeTextFormat(novel.detail.createDate)\n        novel.chapterInfo = `${novel.updateDate}ã€€ã€€${novel.textCount}å­—`\n        delete novel.detail\n    })\n    // java.log(JSON.stringify(novels))\n    return novels\n}\n\n(() => {\n    let resp = util.getNovelRes(result)\n    if (resp.novels) {\n        return seriesHandler(resp)\n    } else if (resp.series) {\n        // ä¼˜åŒ– æœªç¼“å­˜ç³»åˆ—ç›®å½•çš„æƒ…å†µ\n        return seriesContentHandler(resp)\n    } else {\n        return oneShotHandler(resp)\n    }\n})()",
            "chapterName": "title",
            "chapterUrl": "chapterUrl",
            "updateTime": "chapterInfo"
        },
        "searchUrl": "@js:\njava.put(\"key\", key)\njava.put(\"page\", page)\nif (key.startsWith(\"@\") || key.startsWith(\"ï¼ \")) {\n    key = key.slice(1)\n    java.log(`ğŸ‘¤ æœç´¢ä½œè€…ï¼š${key}`)\n} else if (key.startsWith(\"#\") || key.startsWith(\"ï¼ƒ\")) {\n    key = key.slice(1)\n    java.log(`#ï¸âƒ£ æœç´¢æ ‡ç­¾ï¼š${key}`)\n} else {\n    java.log(`ğŸ” æœç´¢å†…å®¹ï¼š${key}`)\n}\nurlSearchNovel(key, page)",
        "variableComment": "âš™ï¸ ä¹¦æºè®¾ç½®ï¼š\nè®¾ç½®ï¼šæ‰“å¼€å°è¯´ - èœå• - ç™»å½• - ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®\n\n",
        "weight": 0,
        "lastUpdateTime": 1771689600251
    },
    {
        "bookSourceComment": "ğŸ¯ å…½äººæ§å°è¯´ç«™ä¹¦æºï¼ˆæ›´æ–°ğŸ“†ï¼š2026/02/22ï¼‰\n\nä¹¦æºç‰ˆæœ¬ï¼š262\nä½¿ç”¨è¯´æ˜ï¼šğŸ“Œé˜…è¯» Plus 3.26.0129 ç‰ˆæœ¬å¯ç”¨\nå¯ç”¨åŠŸèƒ½ï¼šâœ…æœç´¢âœ…å‘ç°âœ…æ·»åŠ ç½‘å€âœ…è®¢é˜…æº\næœç´¢å°è¯´ï¼šâœ…å•ç¯‡âœ…ç³»åˆ—âœ…ä½œè€…âœ…æ ‡ç­¾\nå‘ç°å°è¯´ï¼šâœ…çƒ­é—¨å°è¯´âœ…æœ€æ–°å°è¯´âœ…éšä¾¿æ¥ç‚¹\næ·»åŠ ç½‘å€ï¼šâœ…å…½äººæ§å°è¯´ç«™é“¾æ¥\nè®¢é˜…ç”¨æ³•ï¼šç‚¹å‡»è®¢é˜…æºæ‰“å¼€å°è¯´/ç³»åˆ—å°è¯´ï¼Œç‚¹å‡»ã€åŠ å…¥ä¹¦æ¶ã€‘æŒ‰é’®ï¼Œæ·»åŠ å°è¯´åˆ°ä¹¦æ¶\n\nä¹¦æºå‘å¸ƒï¼šPixiv ä¹¦æºé¢‘é“ https://t.me/PixivSource\nå…½äººé˜…è¯»é¢‘é“ https://t.me/FurryReading\né¡¹ç›®åœ°å€ï¼šhttps://github.com/DowneyRem/PixivSource\nä½¿ç”¨æ•™ç¨‹ï¼šhttps://pixivsource.pages.dev/FurryNovel\n\nè§„åˆ™è®¢é˜…ï¼šImport è®¢é˜…æº\nhttps://cdn.jsdelivr.net/gh/DowneyRem/PixivSource@main/import.json\nhttps://raw.githubusercontent.com/DowneyRem/PixivSource/main/import.json\n\nâš™ï¸ ä¹¦æºè®¾ç½®ï¼š\nä¹¦æºç®¡ç† - ç¼–è¾‘ä¹¦æº - åŸºæœ¬ - å˜é‡è¯´æ˜ - ä¿®æ”¹å¹¶ä¿å­˜\n\nğŸ” ç­›é€‰å‘ç°ï¼š\nå‘ç° - é•¿æŒ‰\"å…½äººæ§å°è¯´ç«™\" - ç¼–è¾‘ - å³ä¸Šè§’èœå• - è®¾ç½®æºå˜é‡\nè®¾ç½®æºå˜é‡ï¼šè¾“å…¥æƒ³è¦æœç´¢/ç­›é€‰çš„æ ‡ç­¾ï¼Œä»¥ç©ºæ ¼é—´éš”ï¼ˆæˆ–ä¸€è¡Œä¸€ä¸ªï¼‰ï¼Œä¿å­˜\nå‘ç° - é•¿æŒ‰\"å…½äººæ§å°è¯´ç«™\" - åˆ·æ–° - æŸ¥çœ‹ä»–äººæ”¶è—",
        "bookSourceGroup": "ğŸ” Pixiv,ğŸ² Furry",
        "bookSourceName": "ğŸ¯ å…½äººæ§å°è¯´ç«™",
        "bookSourceType": 0,
        "bookSourceUrl": "https://furrynovel.com",
        "bookUrlPattern": "(https?://)?(www\\.|api\\.)?furrynovel\\.com(/api)?/(zh|en|ja)/novel/\\d+(/chapter/d+)?",
        "concurrentRate": "30/5000",
        "customButton": false,
        "customOrder": 4,
        "enabled": true,
        "enabledCookieJar": true,
        "enabledExplore": true,
        "eventListener": true,
        "exploreUrl": "@js:\nlet keyword = String(source.getVariable()).replace(\"#\", \"\")\nlet key = keyword.split(/[ ã€€,ï¼Œã€\\n]/)\nif (key.includes(\"\")) {\n    key.splice(key.indexOf(\"\"), 1)\n}\nif (key.length === 0) {\n    sleepToast(\"å¯è®¾ç½®æºå˜é‡ï¼Œç­›é€‰å‘ç° ğŸ” \")\n    sleepToast('å‘ç°é¡µ - é•¿æŒ‰\"å…½äººæ§å°è¯´ç«™\" - ç¼–è¾‘ - å³ä¸Šè§’èœå• - è®¾ç½®æºå˜é‡')\n} else {\n    sleepToast(`æ­£åœ¨æœç´¢ï¼š${key.join(\"ã€\")}`)\n}\n\nlet li = [\n    {\"ğŸ”¥ çƒ­é—¨\": `https://api.furrynovel.com/api/novel?page={{page}}&order_by=popular&${key.map(v => \"tags[]=\" + v).join(\"&\")}`},\n    {\"ğŸ†• æœ€æ–°\": `https://api.furrynovel.com/api/novel?page={{page}}&order_by=latest&${key.map(v => \"tags[]=\" + v).join(\"&\")}`},\n    {\"ğŸ”„ éšä¾¿\": `https://api.furrynovel.com/api/novel?page={{page}}&order_by=random&${key.map(v => \"tags[]=\" + v).join(\"&\")}`},\n    {\"ğŸ†™ æ›´æ–°\": \"https://cdn.jsdelivr.net/gh/DowneyRem/PixivSource@main/linpx.json\"},\n    {\"ğŸ“™ ä¹¦æºç›¸å…³ ğŸ“™\": \"\"},\n    {\"ğŸ  ä¸»é¡µ\": \"https://pixivsource.pages.dev\"},\n    {\"ğŸ”° æŒ‡å—\": \"https://pixivsource.pages.dev/FurryNovel\"},\n    {\"ğŸ åé¦ˆ\": \"https://github.com/DowneyRem/PixivSource/issues\"},\n    {\"ğŸ’° æ‰“èµ\": \"https://pixivsource.pages.dev/Sponsor\"},\n]\n\n// æ ¼å¼åŒ–å‘ç°åœ°å€\nli.forEach(item => {\n    item.title = Object.keys(item)[0]\n    item.url = Object.values(item)[0]\n    delete item[Object.keys(item)[0]]\n    item.style = {}\n    item.style.layout_flexGrow = 1\n    item.style.layout_flexShrink = 1\n    item.style.layout_alignSelf = \"auto\"\n    item.style.layout_wrapBefore = \"false\"\n    if (item.url === \"\") {\n        item.style.layout_flexBasisPercent = 1\n    } else {\n        item.style.layout_flexBasisPercent = -1\n    }\n})\nJSON.stringify(li)",
        "header": "",
        "jsLib": "var cacheSaveSeconds = 30*24*60*60  // é•¿æœŸç¼“å­˜ 30 å¤©\nvar cacheTempSeconds = 10*60*1000   // å†·å´æ—¶é—´ 10 åˆ†é’Ÿ\n\nfunction cacheGetAndSet(key, supplyFunc, requestUpdate) {\n    const {java, cache} = this\n    let timestamp = 0\n    let v = this.getFromCacheObject(key)\n    if (Array.isArray(v)) {\n        try {\n            timestamp = v[0].timestamp\n        } catch (e) {\n            timestamp = 0\n        }\n    } else if (v) {\n        timestamp = v.timestamp\n    }\n\n    const isExpired = v && (new Date().getTime() >= timestamp + cacheTempSeconds)\n    const isError = v && (v.error === true) && isExpired\n    requestUpdate = requestUpdate && isExpired\n\n    if (!v || requestUpdate || isError) {\n        v = supplyFunc()\n        let now = new Date().getTime()\n        // getAjaxJson getWebviewJson æ—¶é—´æˆ³å†™å…¥å¯¹è±¡æœ¬èº«\n        if (!Array.isArray(v)) {\n            v = Object.assign({timestamp: now}, v)\n        }\n        // else {\n        //     // getAjaxAllJson æ—¶é—´æˆ³å†™å…¥ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆè¯»å–æ—¶ v[0].timestampï¼‰// ä¸é‡å¤å†™å…¥\n        //     if (v.length > 0) v[0] = Object.assign({timestamp: now}, v[0])\n        // }\n        this.putInCacheObject(key, v, cacheSaveSeconds)\n    }\n    return v\n}\n\nfunction putInCache(name, object, saveSeconds) {\n    const {java, cache} = this\n    if (saveSeconds === undefined) saveSeconds = 0\n    if (object) {\n        cache.put(name, object, saveSeconds)\n    }\n}\nfunction getFromCache(name) {\n    const {java, cache} = this\n    let object = cache.get(name)\n    if (object === undefined) return null  // å…¼å®¹æºé˜…\n    return object\n}\n\nfunction putInCacheObject(objectName, object, saveSeconds) {\n    const {java, cache} = this\n    if (object === undefined) object = null\n    if (saveSeconds === undefined) saveSeconds = 0\n    cache.put(objectName, JSON.stringify(object), saveSeconds)\n}\nfunction getFromCacheObject(objectName) {\n    const {java, cache} = this\n    let object = cache.get(objectName)\n    if (object === undefined) return null  // å…¼å®¹æºé˜…\n    return JSON.parse(object)\n}\n\nfunction getAjaxJson(url, requestUpdate) {\n    const {java, cache} = this\n    return this.cacheGetAndSet(url, () => {\n        return JSON.parse(java.ajax(url))\n    }, requestUpdate)\n}\nfunction getAjaxAllJson(urls, requestUpdate) {\n    const {java, cache} = this\n    let batchKey = JSON.stringify(urls)\n    return this.cacheGetAndSet(batchKey, () => {\n        let results = []\n        let now = new Date().getTime()\n        let responses = java.ajaxAll(urls)\n        for (let i in urls) {\n            let data = JSON.parse(responses[i].body())\n            data = Object.assign({timestamp: now}, data)\n            results.push(data)\n            this.putInCacheObject(urls[i], data, cacheSaveSeconds)\n        }\n        return results\n    }, requestUpdate)\n}\n\nfunction getWebViewUA() {\n    const {java, cache} = this\n    let userAgent = this.getFromCache(\"userAgent\")\n    if (userAgent) return String(userAgent)\n\n    userAgent = String(java.getWebViewUA())\n    if (userAgent.includes(\"Windows NT 10.0; Win64; x64\")) {\n        userAgent = \"Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Mobile Safari/537.36\"\n    }\n    userAgent += \" Reader\"\n    // java.log(`userAgent=${userAgent}`)\n    this.putInCache(\"userAgent\", userAgent, cacheSaveSeconds/7)\n    return String(userAgent)\n}\nfunction startBrowser(url, title) {\n    const {java} = this\n    if (!title) title = url\n    let msg = \"\"\n    let headers = {}\n    headers[\"User-Agent\"] = this.getWebViewUA()\n\n    if (url.includes(\"github.com\") || url.includes(\"github.io\")) {\n        msg += \"\\n\\nå³å°†æ‰“å¼€ Github\\nè¯·ç¡®è®¤å·²å¼€å¯ä»£ç†/æ¢¯å­/VPNç­‰\"\n    }\n    this.sleepToast(msg, 0.01)\n    java.startBrowser(`${url}, ${JSON.stringify({headers: headers})}`, title)\n}\n\nfunction urlNovelUrl(novelId) {\n    return `https://furrynovel.com/zh/novel/${novelId}`\n}\nfunction urlNovelDetail(novelId) {\n    return `https://api.furrynovel.com/api/zh/novel/${novelId}`\n}\nfunction urlNovelsDetail(novelIds) {\n    return `https://api.furrynovel.com/api/zh/novel?${novelIds.map(v => \"ids[]=\" + v).join(\"&\")}`\n}\nfunction urlNovelChapterUrl(novelId, chapterId) {\n    return `https://furrynovel.com/zh/novel/${novelId}/chapter/${chapterId}`\n}\nfunction urlNovelChapterInfo(novelId) {\n    return `https://api.furrynovel.com/api/zh/novel/${novelId}/chapter`\n}\nfunction urlNovelChapterDetail(novelId, chapterId) {\n    return `https://api.furrynovel.com/api/zh/novel/${novelId}/chapter/${chapterId}`\n}\n\nfunction urlSourceUrl(source, oneShot, sourceId) {\n    if (source === \"bilibili\") {\n        return `https://www.bilibili.com/read/readlist/rl${sourceId}/`\n    }\n    if (source === \"pixiv\" && oneShot === true) {\n        return `https://www.pixiv.net/novel/show.php?id=${sourceId}`\n    }\n    if (source === \"pixiv\" && oneShot === false) {\n        return `https://www.pixiv.net/novel/series/${sourceId}`\n    }\n}\n\nfunction urlSearchNovel(name, page) {\n    return `https://api.furrynovel.com/api/zh/novel?page=${page}&order_by=popular&keyword=${name}`\n}\nfunction urlSearchUser(name, page) {\n    return `https://api.furrynovel.com/api/zh/novel?keyword=${name}&page=${page}`\n}\nfunction urlUserUrl(name) {\n    return `https://furrynovel.com/zh/search?keyword=${name}`\n}\n\nfunction urlLinpxNovelDetail(sourceId) {\n    return `https://api.furrynovel.ink/pixiv/novel/${sourceId}/cache`\n}\nfunction urlLinpxCoverUrl(pxImgUrl) {\n    if (!pxImgUrl.trim()) return \"\"\n    let url = `https://pximg.furrynovel.ink/?url=${pxImgUrl}&w=800`\n    let headers = {\"Referer\": \"https://furrynovel.ink/\"}\n    return `${url}, ${JSON.stringify({headers: headers})}`\n}\n\nfunction urlIllustUrl(illustId) {\n    return `https://www.pixiv.net/artworks/${illustId}`\n}\nfunction urlIllustDetailed(illustId) {\n    return `https://www.pixiv.net/ajax/illust/${illustId}?lang=zh`\n}\n// ç›´è¿åŠŸèƒ½å‚è€ƒè‡ª æ´›å¨…æ©™çš„é˜…è¯»ä»“åº“\n// https://github.com/Luoyacheng/yuedu\n// å…¶ç›´è¿åŠŸèƒ½å‚è€ƒè‡ª PixEz Flutter\n// https://github.com/Notsfsssf/pixez-flutter\nfunction urlIP(url) {\n    const {java, cache} = this\n    url = url.replace(\"http://\", \"https://\").replace(\"www.pixiv.net\", \"210.140.139.155\")\n    let headers = {\n        \"User-Agent\": this.getWebViewUA(),\n        \"X-Requested-With\": \"XMLHttpRequest\",\n        \"Host\": \"www.pixiv.net\",\n        \"Referer\": \"https://www.pixiv.net/\"\n    }\n    return `${url}, ${JSON.stringify({headers: headers})}`\n}\nfunction urlPixivCoverUrl(url) {\n    const {java, cache} = this\n    if (url && !url.trim()) return \"\"\n    let headers = {\"Referer\": \"https://www.pixiv.net/\"}\n\n    if (url.trim()) {\n        if (url.includes(\"i.pximg.net\")) {\n            url = url.replace(\"https://i.pximg.net\", \"https://210.140.139.133\")\n            headers.Host = \"i.pximg.net\"\n        } else {\n            url = url.replace(\"https://s.pximg.net\", \"https://210.140.139.133\")\n            headers.Host = \"s.pximg.net\"\n        }\n    }\n    return `${url}, ${JSON.stringify({headers: headers})}`\n}\nfunction urlIllustOriginal(illustId, order) {\n    const {java, cache} = this\n    if (!order || order <= 1) order = 1\n    let illustOriginal = \"\"\n\n    let resp = this.getAjaxJson(this.urlIP(urlIllustDetailed(illustId)))\n    try {\n        illustOriginal = resp.body.urls.original\n    } catch (e) {\n        try {\n            let illustThumb = resp.body.userIllusts[illustId].url\n            let date = illustThumb.match(\"\\\\d{4}\\\\/\\\\d{2}\\\\/\\\\d{2}\\\\/\\\\d{2}\\\\/\\\\d{2}\\\\/\\\\d{2}\")[0]\n            illustOriginal = `https://i.pximg.net/img-master/img/${date}/${illustId}_p0_master1200.jpg`\n        } catch (e) {}\n    }\n\n    if (illustOriginal.split(\",\")[0] === \"\") return \"\"\n    return this.urlPixivCoverUrl(illustOriginal.replace(`_p0`, `_p${order - 1}`))\n}\n\nfunction addZero(num) {\n    return String(num).padStart(2, '0')\n}\nfunction dateFormat(str) {\n    let time = new Date(str);\n    let Y = time.getFullYear() + \"å¹´\";\n    let M = this.addZero(time.getMonth() + 1) + \"æœˆ\";\n    let D = this.addZero(time.getDate()) + \"æ—¥\";\n    return Y + M + D;\n}\nfunction timeFormat(str) {\n    let time = new Date(str);\n    let YY = time.getFullYear()\n    let MM = this.addZero(time.getMonth() + 1)\n    let DD = this.addZero(time.getDate())\n    let hh = this.addZero(time.getHours())\n    let mm = this.addZero(time.getMinutes())\n    let ss = this.addZero(time.getSeconds())\n    return `${YY}-${MM}-${DD} ${hh}:${mm}:${ss}`\n}\nfunction timeTextFormat(text) {\n    return `${text.slice(0, 10)} ${text.slice(11, 19)}`\n}\n\nfunction sleep(seconds) {\n    return Packages.java.lang.Thread.sleep(1000*seconds)\n}\nfunction sleepToast(text, seconds) {\n    let {java} = this\n    java.log(text)\n    java.longToast(text)\n    if (seconds === undefined) {seconds = 0.01}\n    this.sleep(seconds)\n}\n\nfunction setDefaultSettings() {\n    const {java, cache} = this\n    let settings = {}\n    settings.CONVERT_CHINESE = true     // æœç´¢ï¼šæœç´¢æ—¶è¿›è¡Œç¹ç®€è½¬æ¢\n    settings.MORE_INFORMATION = false   // è¯¦æƒ…ï¼šä¹¦ç±ç®€ä»‹æ˜¾ç¤ºæ›´å¤šä¿¡æ¯\n\n    settings.SHOW_ORIGINAL_LINK = true  // ç›®å½•ï¼šæ˜¾ç¤ºåŸå§‹é“¾æ¥ï¼Œä½†ä¼šå¢åŠ å¤§é‡è¯·æ±‚\n    settings.REPLACE_TITLE_MARKS = true // æ­£æ–‡ï¼šæ³¨éŸ³å†…å®¹ä¸ºæ±‰å­—æ—¶ï¼Œæ›¿æ¢ä¸ºä¹¦åå·\n\n    settings.DEBUG = false              // å…¨å±€ï¼šè°ƒè¯•æ¨¡å¼\n\n    this.putInCacheObject(\"FNSettings\", settings)\n    return settings\n}\n\nfunction updateSource() {\n    const {java, source} = this\n    java.longToast(\"ğŸ†™ æ›´æ–°ä¹¦æº\\n\\nJsdelivr CDN æ›´æ–°æœ‰å»¶è¿Ÿ\\nGithub æ›´æ–°éœ€ä»£ç†\")\n    let onlineSource, comment, sourceName, sourceNameCapitalize, index = 0\n    if (source.bookSourceUrl.includes(\"pixiv\")) sourceName = \"pixiv\"\n    else if (source.bookSourceUrl.includes(\"furrynovel\")) sourceName = \"linpx\"\n    sourceNameCapitalize = sourceName[0].toUpperCase() + sourceName.substring(1)\n\n    if (source.bookSourceName.includes(\"å¤‡ç”¨\")) index = 1\n    else if (source.bookSourceName.includes(\"æ¼«ç”»\")) index = 2\n    if (source.bookSourceUrl.includes(\"furrynovel.com\")) {\n        sourceNameCapitalize = \"FurryNovel\"\n        index = 1\n    }\n\n    try {\n        let updateUrl = `https://cdn.jsdelivr.net/gh/DowneyRem/PixivSource@main/${sourceName}.json`\n        onlineSource = JSON.parse(java.get(updateUrl,{'User-Agent': 'Mozilla/5.0 (Linux; Android 14)','X-Requested-With': 'XMLHttpRequest'}).body())[index]\n    } catch (e) {\n        try {\n            let updateUrl = `https://raw.githubusercontent.com/DowneyRem/PixivSource/main/${sourceName}.json`\n            onlineSource = JSON.parse(java.get(updateUrl,{'User-Agent': 'Mozilla/5.0 (Linux; Android 14)','X-Requested-With': 'XMLHttpRequest'}).body())[index]\n        } catch (e) {\n            onlineSource = {lastUpdateTime: new Date().getTime(), bookSourceComment: source.bookSourceComment}\n        }\n    }\n    comment = onlineSource.bookSourceComment.split(\"\\n\")\n    // onlineSource = source\n    // comment = source.bookSourceComment.split(\"\\n\")\n\n    let htm = `\n<!DOCTYPE html>\n<html lang=\"zh-CN\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>æ›´æ–° ${source.bookSourceName} ä¹¦æº</title>\n    <style> \n    table { text-align: center; margin: 0 auto; } .ann { display: flex; justify-content: center; align-items: center; height: 5vh; } \n    button { background-color: rgb(76, 175, 80); color: white; border: none; border-radius: 4px; height: 6vh; width: 30vw; overflow: hidden; } \n    button span { cursor: pointer; display: inline-block; position: relative; transition: 0.4s; } \n    button span:after { content: '>'; position: absolute; opacity: 0; top: 0; right: 30px; transition: 0.2s; } \n    button:active span { padding-right: 20px; } \n    button:active span:after { opacity: 1; right: -40px; }\n    </style>\n</head>\n\n<body>\n    <table border=\"1\" cellspacing=\"0\">\n        <th colspan=\"2\"> ${source.bookSourceName} ä¹¦æº \n        <a href=\"https://pixivsource.pages.dev/${sourceNameCapitalize}\">ğŸ”° ä½¿ç”¨æŒ‡å—</a>\n        || <a href=\"https://pixivsource.pages.dev/Sponsor\">â¤ï¸ èµåŠ©å¼€å‘</a>\n        </th>\n        <tr>\n            <td>â˜ï¸ è¿œç¨‹ç‰ˆæœ¬ï¼š${onlineSource.bookSourceComment.split(\"\\n\")[2].replace(\"ä¹¦æºç‰ˆæœ¬ï¼š\", \"\")}</td>\n            <td>ğŸ“† æ›´æ–°ï¼š${timeFormat(onlineSource.lastUpdateTime)}</td>\n        </tr>\n        <tr>\n            <td>ğŸ“¥ æœ¬åœ°ç‰ˆæœ¬ï¼š${source.bookSourceComment.split(\"\\n\")[2].replace(\"ä¹¦æºç‰ˆæœ¬ï¼š\", \"\")}</td>\n            <td>ğŸ“† æ›´æ–°ï¼š${timeFormat(source.lastUpdateTime)}</td>\n        </tr> \n        <tr><td colspan=\"2\" style=\"text-align: left;\">${comment.slice(3, 9).join(\"<br>\")}</td></tr>\n        <tr><td colspan=\"2\" style=\"text-align: left;\">${comment.slice(comment.length-7, comment.length).join(\"<br>\")}</td></tr>\n    </table>\n    \n    <table border=\"0\" cellspacing=\"20\">\n        <th colspan=\"2\"> æ›´æ–° ${source.bookSourceName} ä¹¦æº </th>\n        <tr><td><div class=\"ann\">\n            <a href=\"legado://import/importonline?src=https://cdn.jsdelivr.net/gh/DowneyRem/PixivSource@main/${sourceName}.json\">\n            <button><span>æ›´æ–°ä¹¦æº<br>(Jsdelivr CDN)</span></button>\n            </a></div></td>\n            \n            <td><div class=\"ann\">\n            <a href=\"legado://import/importonline?src=https://cdn.jsdelivr.net/gh/DowneyRem/PixivSource@main/btsrk.json\">\n            <button><span>æ›´æ–°è®¢é˜…<br>(Jsdelivr CDN)</span></button>\n            </a></div></td>\n        </tr>\n        \n        <tr><td><div class=\"ann\">\n            <a href=\"legado://import/importonline?src=https://raw.githubusercontent.com/DowneyRem/PixivSource/main/${sourceName}.json\">\n            <button><span>ä¹¦æºé“¾æ¥<br>(GitHub)</span></button>\n            </a></div></td>\n            \n            <td><div class=\"ann\">\n            <a href=\"legado://import/importonline?src=https://raw.githubusercontent.com/DowneyRem/PixivSource/main/btsrk.json\">\n            <button><span>è®¢é˜…é“¾æ¥<br>(GitHub)</span></button>\n            </a></div></td>\n        </tr>\n        \n        <tr><td><div class=\"ann\">\n            <a href=\"legado://import/importonline?src=https://codeberg.org/DowneyRem/PixivSource/raw/branch/main/${sourceName}.json\">\n            <button><span>å¤‡ç”¨ä¹¦æºé“¾æ¥<br>(Codeberg)</span></button>\n            </a></div></td>\n            \n            <td><div class=\"ann\">\n            <a href=\"legado://import/importonline?src=https://codeberg.org/DowneyRem/PixivSource/raw/branch/main/btsrk.json\">\n            <button><span>å¤‡ç”¨è®¢é˜…é“¾æ¥<br>(Codeberg)</span></button>\n            </a></div></td>\n        </tr>\n    </table>\n</body>\n</html>`\n    java.startBrowser(`data:text/html;charset=utf-8;base64, ${java.base64Encode(htm)}`, 'æ›´æ–°ä¹¦æº')\n    return []\n}",
        "lastUpdateTime": 1771689600251,
        "loginCheckJs": "var util = {}\n\nfunction objStringify(obj) {\n    return JSON.stringify(obj, (n, v) => {\n        if (typeof v == \"function\")\n            return v.toString();\n        return v;\n    });\n}\n\n// æ£€æµ‹ æºé˜…\n// å¯ç”¨ java.ajax() ä¸å¯ç”¨ java.webview() java.ajaxAll()\n// å¯ç”¨ java.getCookie() cache.put() cache.get() é»˜è®¤å€¼ä¸º undefined\n// å¯ç”¨ java.startBrowser() ä¸å¯ç”¨ java.startBrowserAwaitAwait\n// å¯ç”¨ source.bookSourceName source.getVariable() source.setVariable()ç­‰\n// java.getUserAgent() java.getWebViewUA() ç›®å‰è¿”å›å†…å®¹ç›¸åŒ\nfunction isSourceRead() {\n    return java.getUserAgent() === java.getWebViewUA()\n}\n// æ­£å¼ç‰ˆ ä¸æ”¯æŒåœ¨ JSlib çš„å‡½æ•°ç›´æ¥è®¾ç½®é»˜è®¤å‚æ•°\n// æ­£å¼ç‰ˆ ä¸æ”¯æŒ a?.b çš„å†™æ³•\n// æ£€æµ‹ é˜…è¯» æ­£å¼ç‰ˆ ä¸ Beta ç‰ˆæœ¬\nfunction isLegadoOfficial() {\n    let isLegadoOfficialStatus\n    try {\n        eval('({})?.value')\n        isLegadoOfficialStatus = false\n    } catch (e) {\n        isLegadoOfficialStatus = true\n    }\n    return isLegadoOfficialStatus\n}\n// æ£€æµ‹ é˜…è¯» Beta ç‰ˆæœ¬ ä¸ LYC ç‰ˆæœ¬\n// LYC ç‰ˆæœ¬æ–°å¢å‡½æ•°\n// java.ajaxTestAll()\n// java.openVideoPlayer(url: String, title: String, float: Boolean)\n// cookie.setWebCookie(url,cookie)\n// source.refreshExplore()\n// source.refreshJSLib()\nfunction isLegadoLYC() {\n    return typeof java.ajaxTestAll === \"function\"\n}\n\nfunction publicFunc() {\n    let u = {}\n    // è¾“å‡ºä¹¦æºä¿¡æ¯\n    java.log(`${source.bookSourceComment.split(\"\\n\")[0]}`)\n    java.log(`ğŸ“Œ ${source.bookSourceComment.split(\"\\n\")[2]}`)\n    java.log(`ğŸ“† æ›´æ–°æ—¶é—´ï¼š${java.timeFormat(source.lastUpdateTime)}`)\n\n    if (isSourceRead()) {\n        java.log(\"ğŸ“± è½¯ä»¶å¹³å°ï¼šğŸ æºé˜… SourceRead\")\n    } else if (isLegadoOfficial()) {\n        java.log(\"ğŸ“± è½¯ä»¶å¹³å°ï¼šğŸ¤– é˜…è¯» æ­£å¼ç‰ˆ\")\n        sleepToast(\"\\nâš ï¸å½“å‰è½¯ä»¶ä¸ºï¼šé˜…è¯»ã€æ­£å¼ç‰ˆã€‘\\nã€æ­£å¼ç‰ˆã€‘å·²å¹´ä¹…å¤±ä¿®ï¼Œä¸æ¨èç»§ç»­ä½¿ç”¨\\n\\nä¸ºäº†æ›´å¥½çš„ä½¿ç”¨ä½“éªŒï¼Œè¯·ç”¨ï¼š\\nã€é˜…è¯» Plusã€‘æˆ–ã€é˜…è¯» Beta æ–°åŒ…åã€‘\\n\\nå³å°†ä¸ºæ‚¨æ‰“å¼€ã€é˜…è¯» Plusã€‘ä¸‹è½½ç•Œé¢\")\n        sleep(3); startBrowser(\"https://loyc.xyz/c/legado.html#download\", \"ä¸‹è½½é˜…è¯» Plus\")\n\n    } else {\n        if (isLegadoLYC()) {\n            java.log(\"ğŸ“± è½¯ä»¶å¹³å°ï¼šğŸ¤– é˜…è¯» Betaã€æ–°åŒ…åã€‘/ é˜…è¯» Plus\")\n        } else {\n            java.log(\"ğŸ“± è½¯ä»¶å¹³å°ï¼šğŸ¤– é˜…è¯» Betaã€åŸåŒ…åã€‘\")\n            sleepToast(\"\\nâš ï¸å½“å‰è½¯ä»¶ä¸ºï¼šé˜…è¯» Betaã€åŸåŒ…åã€‘\\n\\nä¸ºäº†æ›´å¥½çš„ä½¿ç”¨ä½“éªŒï¼Œè¯·ç”¨ï¼š\\nã€é˜…è¯» Plusã€‘æˆ–ã€é˜…è¯» Beta æ–°åŒ…åã€‘\\n\\nå³å°†ä¸ºæ‚¨æ‰“å¼€ã€é˜…è¯» Plusã€‘ä¸‹è½½ç•Œé¢\")\n            sleep(3); startBrowser(\"https://loyc.xyz/c/legado.html#download\", \"ä¸‹è½½é˜…è¯» Plus\")\n        }\n    }\n\n    // è®¾ç½®åˆå§‹åŒ–\n    // cache.delete(\"linpxSettings\")\n    settings = getFromCacheObject(\"linpxSettings\")\n    if (settings) {\n        java.log(\"âš™ï¸ ä½¿ç”¨è‡ªå®šä¹‰è®¾ç½®\")\n    } else {\n        java.log(\"âš™ï¸ ä½¿ç”¨é»˜è®¤è®¾ç½®\")\n        settings = setDefaultSettings()\n    }\n    u.settings = settings\n    putInCacheObject(\"FNSettings\", settings)  // è®¾ç½®å†™å…¥ç¼“å­˜\n\n    u.environment = {}\n    u.environment.IS_SOURCEREAD = isSourceRead()\n    u.environment.IS_LEGADO = !isSourceRead()\n    u.environment.IS_LYC_BRUNCH = isLegadoLYC()\n    putInCacheObject(\"pixivEnvironment\", u.environment)  // è®¾ç½®å†™å…¥ç¼“å­˜\n\n    if (u.DEBUG === true) {\n        java.log(JSON.stringify(settings, null, 4))\n        java.log(`DEBUG = ${u.DEBUG}`)\n    }\n    u.debugFunc = (func) => {\n        if (util.settings.DEBUG) {\n            func()\n        }\n    }\n\n    u.getNovels = function () {\n        if (JSON.parse(result).code === 200 && JSON.parse(result).count > 0) {\n            return JSON.parse(result).data\n        } else {\n            return []\n        }\n    }\n\n    u.handNovels = function (novels) {\n        novels.forEach(novel =>{\n            // novel.id = novel.id\n            novel.title = novel.name\n            // novel.tags = novel.tags\n            novel.userName = novel.author.name\n            // novel.userId = novel.author.id\n            novel.textCount = null\n            if (novel.latest_chapters === undefined) {\n                novel.latestChapter = null\n                novel.detailedUrl = urlNovelDetail(novel.id)\n            } else {\n                novel.latestChapter = novel.latest_chapters[0].name\n                novel.detailedUrl = urlNovelUrl(novel.id)\n            }\n            novel.description = novel.desc\n            novel.coverUrl = novel.cover\n            novel.sourceUrl = urlSourceUrl(novel.source, novel.ext_data.oneshot, novel.source_id)\n\n            novel.createDate = novel.created_at\n            novel.updateDate = novel.updated_at\n            novel.syncDate = novel.fetched_at\n            // novel.status = novel.status\n            // if (novel.status !== \"publish\") {  // suspend\n            //     java.log(urlNovelUrl(novel.id))\n            //     java.log(novel.sourceUrl)\n            // }\n        })\n        return novels\n    }\n\n    u.formatNovels = function (novels) {\n        novels.forEach(novel => {\n            novel.title = novel.title.trim()\n            if (!novel.userName.startsWith(\"@\")) novel.userName = `@${novel.userName}`\n            novel.tags2 = []\n            for (let i in novel.tags) {\n                let tag = novel.tags[i]\n                if (tag.includes(\"/\")) {\n                    let tags = tag.split(\"/\")\n                    novel.tags2 = novel.tags2.concat(tags)\n                } else {\n                    novel.tags2.push(tag)\n                }\n            }\n            novel.tags = Array.from(new Set(novel.tags2))\n            novel.tags = novel.tags.join(\",\")\n            novel.createDate = dateFormat(novel.createDate)\n            novel.updateDate = dateFormat(novel.updateDate)\n            novel.syncDate = dateFormat(novel.syncDate)\n            if (util.settings.MORE_INFORMATION) {\n                novel.description = `\\nä¹¦åï¼š${novel.title}\\nä½œè€…ï¼š${novel.userName}\\næ ‡ç­¾ï¼š${novel.tags}\\nä¸Šä¼ ï¼š${novel.createDate}\\næ›´æ–°ï¼š${novel.updateDate}\\nåŒæ­¥ï¼š${novel.syncDate}\\nç®€ä»‹ï¼š${novel.description}`\n            } else {\n                novel.description = `\\n${novel.description}\\nä¸Šä¼ æ—¶é—´ï¼š${novel.createDate}\\næ›´æ–°æ—¶é—´ï¼š${novel.updateDate}\\nåŒæ­¥æ—¶é—´ï¼š${novel.syncDate}`\n            }\n        })\n        return novels\n    }\n\n    u.getNovelRes = function (result, type) {\n        let res = {data: []}, chapterId = 0\n        let isHtml = result.startsWith(\"<!DOCTYPE html>\")\n        let pattern = \"(https?://)?(www\\\\.)?furrynovel\\\\.com/(zh|en|ja)/novel/\\\\d+(/chapter/d+)?\"\n        let fnWebpage = baseUrl.match(new RegExp(pattern))\n\n        if (isHtml && fnWebpage) {\n            let novelId = baseUrl.match(new RegExp(\"\\\\d+\"))[0]\n            if (type === \"detail\") {\n                res = getAjaxJson(urlNovelDetail(novelId))\n            } else if (type === \"catalog\") {\n                res = getAjaxJson(urlNovelChapterInfo(novelId))\n            } else if (type === \"content\") {\n                try {\n                    chapterId = baseUrl.match(RegExp(/\\/(\\d+)\\/chapter\\/(\\d+)/))[2]\n                } catch (e) {\n                    chapterId = getAjaxJson(urlNovelChapterInfo(novelId)).data[0].id\n                } finally {\n                    res = getAjaxJson(urlNovelChapterDetail(novelId, chapterId))\n                }\n            }\n        } else {\n            res = JSON.parse(result)\n        }\n        if (res.data.length === 0) {\n            java.log(`æ— æ³•ä» FurryNovel è·å–å½“å‰å°è¯´`)\n            java.log(JSON.stringify(res))\n        }\n        return res.data\n    }\n\n    util = u\n    java.put(\"util\", objStringify(u))\n}\n\npublicFunc()\njava.getStrResponse(null, null)",
        "loginUi": "@js:\nlet source = [\n    {\"ğŸ†™ æ›´æ–°ä¹¦æº\": \"updateSource()\" },\n    {\"ğŸ”° ä½¿ç”¨æŒ‡å—\": \"startGithubReadme()\" },\n    {\"ğŸ åé¦ˆé—®é¢˜\": \"startGithubIssue()\" },\n]\n\nlet novel = [\n    {\"ç« èŠ‚åç§°\": \"text\" },\n    {\"â¤´ï¸ åˆ†äº«ç« èŠ‚\": \"shareFactory('novel')\" },\n    {\"â¤´ï¸ åˆ†äº«ä½œè€…\": \"shareFactory('author')\" },\n    {\"ğŸ…¿ï¸ åˆ†äº«å°è¯´\": \"shareFactory('pixiv')\" },\n]\n\nlet settings = [\n    {\"ä¹¦æºè®¾ç½®\": \"text\" },\n    {\"âš™ï¸ å½“å‰è®¾ç½®\": \"showSettings()\" },\n    {\"ğŸ”§ é»˜è®¤è®¾ç½®\": \"setDefaultSettingsLoginUrl()\" },\n    {\"ğŸ€„ ğŸš« ç¹ç®€é€šæœ\": \"editSettings('CONVERT_CHINESE')\" },\n\n    {\"ğŸš« ğŸ“– æ›´å¤šç®€ä»‹\": \"editSettings('MORE_INFORMATION')\" },\n    {\"ğŸ”— ğŸš« åŸå§‹é“¾æ¥\": \"editSettings('SHOW_ORIGINAL_LINK')\" },\n    {\"ğŸ“š ğŸš« æ¢å¤ã€Šã€‹\": \"editSettings('REPLACE_TITLE_MARKS')\" },\n]\n\n// æ·»åŠ æŒ‰é’®\nlet li = source\ntry {\n    if (book) li = li.concat(novel)\n} catch (e) {}\nli = li.concat(settings)\n\n// å¤„ç†æŒ‰é’®\nli.forEach(item => {\n    item.name = Object.keys(item)[0]\n    let list = item.name.split(\" \")\n    if (list.length === 1 ) {\n        item.type = \"text\"\n    } else if (list.length === 2) {\n        item.type = \"button\"\n        item.action = Object.values(item)[0]\n    } else {\n        item.name = list[list.length - 1]\n        item.type = \"toggle\"\n        item.default = `${list[0]} `\n        list.length = list.length - 1\n        item.chars = list.map(char => `${char} `)\n        item.action = Object.values(item)[0]\n    }\n    delete item[Object.keys(item)[0]]\n    // æ·»åŠ æ ¼å¼\n    if (item.type === \"button\" || item.type === \"toggle\") {\n        item.style = {}\n        item.style.layout_flexGrow = 1\n        item.style.layout_flexBasisPercent = -1\n    }\n})\n\nJSON.stringify(li)",
        "loginUrl": "function login() {}\n\nfunction getNovel() {\n    let novel = {}\n    novel.bookId = book.bookUrl.match(/\\d+/)[0]\n    novel.bookName = book.name\n    novel.userName = book.author.replace(\"@\", \"\")\n\n    let resp = getAjaxJson(urlNovelDetail(novel.bookId)).data\n    novel.sourceUrl = urlSourceUrl(resp.source, resp.ext_data.oneshot, resp.source_id)\n    sleepToast(JSON.stringify(novel, null, 4))\n    return novel\n}\n\nfunction shareFactory(type) {\n    let novel = getNovel()\n    if (!novel) return sleepToast(\"ğŸ”° åŠŸèƒ½æç¤º\\n\\nâš ï¸ è¯·åœ¨å°è¯´é˜…è¯»é¡µé¢ï¼Œä½¿ç”¨æœ¬åŠŸèƒ½\")\n    if (type.includes(\"author\")) {\n        sleepToast(\"\\n\\nå·²å¤åˆ¶å½“å‰ä½œè€…é“¾æ¥\", 1)\n        java.copyText(urlUserUrl(novel.userName))\n        // startBrowser(urlUserUrl(novel.userName), novel.userName)\n    }\n    else if (type.includes(\"novel\")) {\n        sleepToast(\"\\n\\nå·²å¤åˆ¶å½“å‰å°è¯´è¯¦æƒ…é“¾æ¥\", 1)\n        java.copyText(urlNovelUrl(novel.bookId))\n        // startBrowser(urlNovelUrl(novel.bookId), novel.bookName)\n    }\n    else if (type.includes(\"pixiv\")) {\n        sleepToast(\"\\n\\nå·²å¤åˆ¶å½“å‰å°è¯´ Pixiv é“¾æ¥\", 1)\n        java.copyText(novel.sourceUrl)\n        // startBrowser(novel.sourceUrl, novel.bookName)\n    }\n}\n\nfunction startGithubReadme() {\n    startBrowser(\"https://pixivsource.pages.dev/FurryNovel\", \"ä½¿ç”¨æŒ‡å—\")\n}\nfunction startGithubIssue() {\n    startBrowser(\"https://github.com/DowneyRem/PixivSource/issues\", \"åé¦ˆé—®é¢˜\")\n}\n\nfunction checkStatus(status) {\n    if (eval(String(status)) === true) return \"â¤ï¸\"\n    else return \"ğŸ–¤\"\n}\n\nlet settingsName = {\n    \"CONVERT_CHINESE\": \"ğŸ€„ï¸ ç¹ç®€é€šæœ\",\n    \"MORE_INFORMATION\": \"ğŸ“– æ›´å¤šç®€ä»‹\",\n    \"SHOW_ORIGINAL_LINK\": \"ğŸ”— åŸå§‹é“¾æ¥\",\n    \"REPLACE_TITLE_MARKS\": \"ğŸ“š æ¢å¤ã€Šã€‹\",\n    \"DEBUG\": \"ğŸ è°ƒè¯•æ¨¡å¼\",\n}\n\nfunction statusMsg(status) {\n    if (status === true) return \"âœ… å·²å¼€å¯\"\n    else if (status === false) return \"ğŸš« å·²å…³é—­\"\n    else return \"ğŸˆšï¸ æœªè®¾ç½®\"\n}\n\n// æ£€æµ‹å¿«é€Ÿæ¨¡å¼ä¿®æ”¹çš„4ä¸ªè®¾ç½®\nfunction getSettingStatus(mode) {\n    if (mode === undefined) mode = \"\"\n    let keys = [], msgList = []\n    let settings = getFromCacheObject(\"FNSettings\")\n    keys = Object.keys(settingsName)\n    for (let i in keys) {\n        msgList.push(`${statusMsg(settings[keys[i]])}ã€€${settingsName[keys[i]]}`)\n    }\n    return msgList.join(\"\\n\").trim()\n}\n\nfunction showSettings() {\n    sleepToast(`\\nâš™ï¸ å½“å‰è®¾ç½®\\n\\n${getSettingStatus()}`)\n}\n\nfunction setDefaultSettingsLoginUrl() {\n    setDefaultSettings()\n    sleepToast(`\\nâœ… å·²æ¢å¤ã€€ğŸ”§ é»˜è®¤è®¾ç½®\\n\\n${getSettingStatus()}`)\n}\n\nfunction editSettings(settingName) {\n    let msg, status\n    let settings = getFromCacheObject(\"FNSettings\")\n    if (!settings) settings = setDefaultSettings()\n    if (!!settings[settingName]) {\n        status = settings[settingName] = !settings[settingName]\n    } else {\n        status = settings[settingName] = true\n    }\n    putInCacheObject(\"FNSettings\", settings)\n    msg = `\\n\\n${statusMsg(status)}ã€€${settingsName[settingName]}`\n    sleepToast(msg)\n}",
        "respondTime": 180000,
        "ruleBookInfo": {
            "author": "userName",
            "canReName": "true",
            "coverUrl": "coverUrl",
            "init": "@js:\nvar util = objParse(String(java.get(\"util\")))\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\nfunction novelHandler(novel) {\n    novel = util.formatNovels(util.handNovels([novel]))[0]\n    book.bookUrl = novel.detailedUrl = urlNovelUrl(novel.id)\n    book.tocUrl = novel.catalogUrl = urlNovelChapterInfo(novel.id)\n    return novel\n}\n\n(() => {\n    return novelHandler(util.getNovelRes(result, \"detail\"))\n})();",
            "intro": "description",
            "kind": "tags",
            "lastChapter": "latestChapter",
            "name": "title",
            "tocUrl": "catalogUrl",
            "wordCount": "textCount"
        },
        "ruleContent": {
            "content": "@js:\nvar util = objParse(String(java.get(\"util\")))\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\nfunction replaceUploadedImage(res, content) {\n    // è·å– [uploadedimage:] çš„å›¾ç‰‡é“¾æ¥\n    let hasEmbeddedImages = content.match(RegExp(/\\[uploadedimage:(\\d+)-?(\\d+)]/gm))\n    if (hasEmbeddedImages) {\n        resp = getAjaxJson(urlLinpxNovelDetail(res.source_id))\n        Object.keys(resp.images).forEach((key) => {\n            content = content.replace(`[uploadedimage:${key}]`, `<img src=\"${urlLinpxCoverUrl(resp.images[key].origin)}\">`)\n        })\n    }\n    return content\n}\nfunction replacePixivImage(content) {\n    // è·å– [pixivimage:] çš„å›¾ç‰‡é“¾æ¥ [pixivimage:1234] [pixivimage:1234-1]\n    let matched = content.match(RegExp(/\\[pixivimage:(\\d+)-?(\\d+)]/gm))\n    if (matched) {\n        matched.forEach(pixivimage => {\n            let matched2, illustId, order = 0\n            if (pixivimage.includes(\"-\")) {\n                matched2 = pixivimage.match(RegExp(\"(\\\\d+)-(\\\\d+)\"))\n                illustId = matched2[1]; order = matched2[2]\n            } else {\n                matched2 = pixivimage.match(RegExp(\"\\\\d+\"))\n                illustId = matched2[0];\n            }\n            if (urlIllustOriginal(illustId, order)) {\n                content = content.replace(`${pixivimage}`, `<img src=\"${urlIllustOriginal(illustId, order)}\">`)\n            } else {\n                content = content.replace(`${pixivimage}`, ``)\n            }\n        })\n    }\n    return content\n}\nfunction replaceNewPage(content) {\n    // æ›¿æ¢ Pixiv åˆ†é¡µæ ‡è®°ç¬¦å· [newpage]\n    if (!util.environment.IS_LYC_BRUNCH) {\n        let matched = content.match(RegExp(/[ ã€€]*\\[newpage][ ã€€]*/gm))\n        if (matched) {\n            for (let i in matched) {\n                content = content.replace(`${matched[i]}`, `${\"<p>â€‹<p/>\".repeat(3)}`)\n            }\n        }\n    }\n    return content\n}\nfunction replaceChapter(content) {\n    // æ›¿æ¢ Pixiv ç« èŠ‚æ ‡è®°ç¬¦å· [chapter:]\n    let matched = content.match(RegExp(/\\[chapter:(.*?)]/gm))\n    if (matched) {\n        for (let i in matched) {\n            let matched2 = matched[i].match(/\\[chapter:(.*?)]/m)\n            let chapter = matched2[1].trim()\n            // æ›¿æ¢ Pixiv åˆ†é¡µæ ‡è®°ç¬¦å· [newpage]\n            if (util.environment.IS_LYC_BRUNCH) {\n                content = content.replace(`${matched[i]}`, `<usehtml><h3>${chapter}</h3></usehtml>`)\n            } else {\n                content = content.replace(`${matched[i]}`, `${chapter}<p>â€‹<p/>`)\n            }\n        }\n    }\n    return content\n}\nfunction replaceJumpPage(content) {\n    // æ›¿æ¢ Pixiv è·³è½¬é¡µé¢æ ‡è®°ç¬¦å· [[jump:]]\n    let matched = content.match(RegExp(/\\[jump:(\\d+)]/gm))\n    if (matched) {\n        for (let i in matched) {\n            let page = matched[i].match(/\\d+/)\n            content = content.replace(`${matched[i]}`, `\\n\\nè·³è½¬è‡³ç¬¬${page}èŠ‚`)\n        }\n    }\n    return content\n}\nfunction replaceJumpUrl(content) {\n    // æ›¿æ¢ Pixiv é“¾æ¥æ ‡è®°ç¬¦å· [[jumpuri: > ]]\n    let matched = content.match(RegExp(/\\[\\[jumpuri:(.*?)>(.*?)]]/gm))\n    if (matched) {\n        for (let i in matched) {\n            let matched2 = matched[i].match(/\\[\\[jumpuri:(.*?)>(.*?)]]/m)\n            let matchedText = matched2[0]\n            let urlName = matched2[1].trim()\n            let urlLink = matched2[2].trim()\n\n            if (util.environment.IS_LYC_BRUNCH) {\n                content = content.replace(`${matchedText}`, `<usehtml><p>ã€€ã€€<a href=${urlLink}>${urlName}</a></p></usehtml>`)\n            } else {\n                if (urlLink === urlName) {\n                    content = content.replace(`${matchedText}`, `${urlName}`)\n                } else {\n                    content = content.replace(`${matchedText}`, `${urlName}: ${urlLink}`)\n                }\n            }\n        }\n    }\n    return content\n}\nfunction replaceRb(content) {\n    // æ›¿æ¢ Pixiv æ³¨éŸ³æ ‡è®°ç¬¦å· [[rb: > ]]\n    let matched = content.match(RegExp(/\\[\\[rb:(.*?)>(.*?)]]/gm))\n    if (matched) {\n        for (let i in matched) {\n            let matched2 = matched[i].match(/\\[\\[rb:(.*?)>(.*?)]]/m)\n            let matchedText = matched2[0]\n            let kanji = matched2[1].trim()\n            let kana = matched2[2].trim()\n\n            if (!util.settings.REPLACE_TITLE_MARKS) {\n                // é»˜è®¤æ›¿æ¢æˆï¼ˆæ‹¬å·ï¼‰\n                content = content.replace(`${matchedText}`, `${kanji}ï¼ˆ${kana}ï¼‰`)\n            } else {\n                let reg = RegExp(\"[\\\\u4E00-\\\\u9FFF]+\", \"g\");\n                if (reg.test(kana)) {\n                    // kanaä¸ºä¸­æ–‡ï¼Œåˆ™æ›¿æ¢å›ã€Šä¹¦åå·ã€‹\n                    content = content.replace(`${matchedText}`, `${kanji}ã€Š${kana}ã€‹`)\n                } else {\n                    // é˜…è¯»ä¸æ”¯æŒ <ruby> <rt> æ³¨éŸ³\n                    // content = content.replace(`${matchedText}`, `<ruby>${kanji}<rt>${kana}</rt></ruby>`)\n                    content = content.replace(`${matchedText}`, `${kanji}ï¼ˆ${kana}ï¼‰`)\n                }\n            }\n        }\n    }\n    return content\n}\n\nfunction getContent(res) {\n    let content = res.content\n    // æ›¿æ¢ Pixiv æ ‡è®°ç¬¦\n    content = replaceUploadedImage(res, content)\n    content = replacePixivImage(content)\n    content = replaceNewPage(content)\n    content = replaceChapter(content)\n    content = replaceJumpPage(content)\n    content = replaceJumpUrl(content)\n    content = replaceRb(content)\n    return content\n}\n\n(function () {\n    return getContent(util.getNovelRes(result, \"content\"))\n})()",
            "imageStyle": "FULL",
            "callBackJs": "function shareBook() {\n    let text = `æˆ‘æ­£åœ¨çœ‹ï¼šã€${book.author.replace(\"@\", \"\")}ã€‘åˆ›ä½œçš„ã€Š${book.name}ã€‹`\n    if (!!book.durChapterTitle && String(book.name) !== String(book.durChapterTitle)) {\n        text += `çš„ ã€${book.durChapterTitle}ã€‘`\n    }\n    text += `\\n\\nå°è¯´é“¾æ¥ï¼š\\n${book.bookUrl}\\n\\nåˆ†äº«è‡ªã€å¼€æºé˜…è¯»ã€‘å…½äººæ§å°è¯´ç«™ä¹¦æºã€‚ä½¿ç”¨æ·»åŠ ç½‘å€ï¼Œå¿«é€Ÿæ·»åŠ æœ¬æ–‡`\n    java.copyText(text)\n    return true\n}\n\nfunction clearCache() {\n    let novel = getNovel()\n    cache.delete(urlNovelDetailed(novel.id))\n    if (novel.seriesId) cache.delete(urlSeriesDetailed(novel.seriesId))\n    return true\n}\n\nfunction copyBookUrl() {\n    java.copyText(book.bookUrl)\n    return true\n}\ncopyTocUrl = copyBookUrl\n\n// ä¿å­˜é˜…è¯»ï¼Œæ›´æ–°ç™»å½•ç•Œé¢çš„ç« èŠ‚åç§°\nfunction saveRead() {\n    source.putLoginInfo(JSON.stringify({\"ç« èŠ‚åç§°\": book.durChapterTitle}))\n}\n\nfunction startShelfRefresh() {\n     source.putConcurrent(\"18/30000\")\n}\n\nfunction endShelfRefresh() {\n    source.putConcurrent(\"25/5000\")\n}\n\nfunction callBackFactory(event) {\n    switch (event) {\n        // case \"clickBookName\":\n        //     return clickBookName()\n        // case \"longClickBookName\":\n        //     return longClickBookName()\n        // case \"clickAuthor\":\n        //     return clickAuthor()\n        // case \"longClickAuthor\":\n        //     return longClickAuthor()\n        // case \"clickCustomButton\":\n        //     return customButton()\n        // case \"longClickCustomButton\":\n        //     return longcustomButton()\n\n        case \"clickShareBook\":\n            return shareBook()\n        case \"clickClearCache\":\n            return clearCache()\n        case \"clickCopyBookUrl\":\n            return copyBookUrl()\n        case \"clickCopyTocUrl\":\n            return copyTocUrl()\n\n        // ä¸‹é¢çš„äº‹ä»¶æ— æ³•è¢«å›è°ƒç»“æœæ¶ˆè´¹\n        // case \"addBookShelf\":\n        //     return addBookShelf()\n        // case \"delBookShelf\":\n        //     return delBookShelf()\n        case \"saveRead\":\n            return saveRead()\n        // case \"startRead\":\n        //     return startRead()\n        // case \"endRead\":\n        //     return endRead()\n        case \"startShelfRefresh\":\n            return startShelfRefresh()\n        case \"endShelfRefresh\":\n            return endShelfRefresh()\n    }\n}\n\n(() => {\n    return callBackFactory(event)\n})()"
        },
        "ruleExplore": {
            "author": "userName",
            "bookList": "@js:\nvar util = objParse(String(java.get(\"util\")))\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\nfunction handlerFactory() {\n    if (baseUrl.includes(\"https://cdn.jsdelivr.net\")) {\n        return updateSource()\n    }\n    if (baseUrl.includes(\"furrynovel.com\")) {\n        return util.formatNovels(util.handNovels(util.getNovels()))\n    }\n    else {\n        return startBrowser(baseUrl, \"\")\n    }\n}\n\n(() => {\n    return handlerFactory()\n})()",
            "bookUrl": "detailedUrl",
            "coverUrl": "coverUrl",
            "intro": "description",
            "kind": "tags",
            "lastChapter": "latestChapter",
            "name": "title",
            "wordCount": "textCount"
        },
        "ruleSearch": {
            "author": "userName",
            "bookList": "@js:\nvar util = objParse(String(java.get(\"util\")))\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\nfunction search(name, page=1) {\n    let resp = getAjaxJson(urlSearchNovel(name, page))\n    java.log(urlSearchNovel(name, page))\n    if (resp.code === 200 && resp.count > 0) {\n        return resp.data\n    } else {\n        return []\n    }\n}\n\nfunction getConvertNovels() {\n    let novels = []\n    let novelName = String(java.get(\"key\"))\n    let name1 = String(java.s2t(novelName))\n    let name2 = String(java.t2s(novelName))\n    if (name1 !== novelName) novels = novels.concat(search(name1))\n    if (name2 !== novelName) novels = novels.concat(search(name2))\n    return novels\n}\n\n(() => {\n    let novels = []\n    novels = novels.concat(util.getNovels())\n    if (util.settings.CONVERT_CHINESE) novels = novels.concat(getConvertNovels())\n    novels = novels.sort((a, b) => a.source_id > b.source_id ? 1 : -1)\n    // java.log(JSON.stringify(novels))\n    // è¿”å›ç©ºåˆ—è¡¨ä¸­æ­¢æµç¨‹\n    if (novels.length === 0) {\n        return []\n    }\n    return util.formatNovels(util.handNovels(novels))\n})();",
            "bookUrl": "detailedUrl",
            "checkKeyWord": "#æµ‹è¯•é¡µé¢",
            "coverUrl": "coverUrl",
            "intro": "description",
            "kind": "tags",
            "lastChapter": "latestChapter",
            "name": "title",
            "wordCount": "textCount"
        },
        "ruleToc": {
            "chapterList": "@js:\nvar util = objParse(String(java.get(\"util\")))\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\nfunction urlNovelChapter(novelId, chapterId) {\n    if (util.settings.SHOW_ORIGINAL_LINK) {\n        return urlNovelChapterUrl(novelId, chapterId)\n    } else {\n        return urlNovelChapterDetail(novelId, chapterId)\n    }\n}\n\nfunction novelHandler(novels) {\n    novels.forEach(novel => {\n        novel.chapterId = novel.id\n        novel.novelId = baseUrl.match(RegExp(/\\d+/))[0]\n        novel.detailedUrl = urlNovelUrl(novel.novelId)\n        novel.chapterName = novel.title = novel.name\n        novel.chapterUrl =  urlNovelChapter(novel.novelId, novel.chapterId)\n        novel.chapterInfo = `${novel.created_at}ã€€ã€€${novel.text_count}å­—`\n    })\n    return novels\n}\n\n(function () {\n    return novelHandler(util.getNovelRes(result, \"catalog\"))\n})()",
            "chapterName": "title",
            "chapterUrl": "chapterUrl",
            "updateTime": "chapterInfo"
        },
        "searchUrl": "@js:\njava.put(\"key\", key)\njava.put(\"page\", page)\nif (key.startsWith(\"@\") || key.startsWith(\"ï¼ \")) {\n    key = key.slice(1)\n    java.log(`ğŸ‘¤ æœç´¢ä½œè€…ï¼š${key}`)\n} else if (key.startsWith(\"#\") || key.startsWith(\"ï¼ƒ\")) {\n    key = key.slice(1)\n    java.log(`#ï¸âƒ£ æœç´¢æ ‡ç­¾ï¼š${key}`)\n} else {\n    java.log(`ğŸ” æœç´¢å†…å®¹ï¼š${key}`)\n}\n\njava.put(\"key\", key)\nurlSearchNovel(key, page)",
        "variableComment": "ğŸ” ç­›é€‰å‘ç°ï¼š\nå‘ç° - é•¿æŒ‰\"å…½äººå°è¯´ç«™\" - ç¼–è¾‘ - å³ä¸Šè§’èœå• - è®¾ç½®æºå˜é‡\nè®¾ç½®æºå˜é‡ï¼šè¾“å…¥æƒ³è¦æœç´¢/ç­›é€‰çš„æ ‡ç­¾ï¼Œä»¥ç©ºæ ¼é—´éš”ï¼ˆæˆ–ä¸€è¡Œä¸€ä¸ªï¼‰ï¼Œä¿å­˜\nå‘ç° - é•¿æŒ‰\"å…½äººå°è¯´ç«™\" - åˆ·æ–° - æŸ¥çœ‹ä»–äººæ”¶è—\nä»¥ä¸‹å†…å®¹ä¸ºæºå˜é‡æ¨¡æ¿ï¼š\nä¸­æ–‡ åŸåˆ›  çº¯çˆ±\n\n\nâš™ï¸ ä¹¦æºè®¾ç½®ï¼š\nè®¾ç½®ï¼šæ‰“å¼€å°è¯´ - èœå• - ç™»å½• - ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®\n\n",
        "weight": 0
    }
]