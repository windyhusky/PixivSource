[
    {
        "bookSourceComment": "Linpx 书源（更新时间：2024-11-19）\n\n可用功能：✅搜索✅发现✅添加网址✅订阅源\n搜索小说：✅小说名称✅作者名称✅小说标签\n发现小说：✅推荐作者✅最近更新\n添加网址：✅Linpx小说链接(✅分享链接✅原链接)\n订阅用法：点击订阅源打开小说，点击【添加到书架】按钮添加小说到书架\n温馨提示：⚠️ Linpx 的系列小说 api 目前不会返回小说id，添加系列小说后，无法再次获取目录\n\n书源发布：兽人阅读频道 https://t.me/FurryReading\n项目地址：https://github.com/windyhusky/PixivSource\n\n规则订阅：\n1️⃣ Linpx 书源：\nhttps://cdn.jsdelivr.net/gh/windyhusky/PixivSource@main/linpx.json\nhttps://raw.githubusercontent.com/windyhusky/PixivSource/main/linpx.json\n\n2️⃣ Linpx 订阅源：\nhttps://cdn.jsdelivr.net/gh/windyhusky/PixivSource@main/btsrk.json\nhttps://raw.githubusercontent.com/windyhusky/PixivSource/main/btsrk.json",
        "bookSourceGroup": "🔞 Pixiv",
        "bookSourceName": "Linpx",
        "bookSourceType": 0,
        "bookSourceUrl": "https://furrynovel.ink",
        "bookUrlPattern": "(https?://)?(api\\.|www\\.)?(furrynovel\\.(ink|xyz))/(pn|pixiv/novel)/\\d+(/cache)?",
        "customOrder": 2,
        "enabled": true,
        "enabledCookieJar": false,
        "enabledExplore": true,
        "exploreUrl": "[\n  {\n    \"title\": \"推荐作者\",\n    \"url\": \"https://api.furrynovel.ink/fav/user/cache\",\n    \"style\": {\n      \"layout_flexGrow\": 1,\n      \"layout_flexBasisPercent\":0.3\n    }\n  },\n  {\n    \"title\": \"最新小说\",\n    \"url\": \"https://api.furrynovel.ink/pixiv/novels/recent/cache?page={{page}}\",\n    \"style\": {\n      \"layout_flexGrow\": 1,\n      \"layout_flexBasisPercent\":0.3\n    }\n  }\n]",
        "header": "{\"referer\":\"https://furrynovel.ink/\"}",
        "lastUpdateTime": 1732000697251,
        "loginCheckJs": "var util = {}\n\nfunction objStringify(obj) {\n    return JSON.stringify(obj, (n, v) => {\n        if (typeof v == \"function\")\n            return v.toString();\n        return v;\n    });\n}\n\nfunction publicFunc() {\n    let u = {}\n    u.SHOW_ORIGINAL_NOVEL_LINK = true   // 目录处显示 Pixiv 小说链接，但会增加请求次数\n    // u.SHOW_ORIGINAL_NOVEL_LINK = false  // 目录不显示 Pixiv 小说链接，可以减少请求次数\n    u.REPLACE_WITH_BOOK_TITLE_MARKS = true  // 注音内容为汉字时，替换为书名号 `[[rb:汉字 > 注音]] => 汉字《注音》`\n    // u.REPLACE_WITH_BOOK_TITLE_MARKS = false // 注音内容默认替换为括号`[[rb:汉字 > 注音]] => 汉字（注音）`\n\n    u.cacheGetAndSet = function (key, supplyFunc) {\n        let v = cache.get(key)\n        if (v === undefined || v === null) {\n            v = JSON.stringify(supplyFunc())\n            // 缓存10分钟\n            cache.put(key, v, 600)\n        }\n        return JSON.parse(v)\n    }\n    u.getAjaxJson = function (url) {\n        return util.cacheGetAndSet(url, () => {\n            return JSON.parse(java.ajax(url))\n        })\n    }\n    u.getWebviewJson = function (url) {\n        return util.cacheGetAndSet(url, () => {\n            let html = java.webView(null, url, null)\n            return JSON.parse((html.match(new RegExp(\">\\\\[{.*?}]<\"))[0].replace(\">\", \"\").replace(\"<\", \"\")))\n        })\n    }\n    u.debugFunc = (func) => {\n        if (String(source.getVariable()) === \"debug\") {\n            func()\n        }\n    }\n\n    u.urlNovelDetailed = function (id){\n        return `https://api.furrynovel.ink/pixiv/novel/${id}/cache`\n    }\n    u.urlNovelsDetailed = function (nidList) {\n        return `https://api.furrynovel.ink/pixiv/novels/cache?${nidList.map(v => \"ids[]=\" + v).join(\"&\")}`\n    }\n    u.urlNovelUrl = function (id){\n        return `https://furrynovel.ink/pixiv/novel/${id}/cache`\n    }\n    u.urlNovel = (novelId) => {\n        if (util.SHOW_ORIGINAL_NOVEL_LINK === true) {\n            return util.urlNovelUrl(novelId)\n        } else {\n            return util.urlNovelDetailed(novelId)\n        }\n    }\n    // u.urlSeriesUrl = function (id) {\n    //     return `https://furrynovel.ink/pixiv/series/${id}/cache`\n    // }\n    u.urlSeriesDetailed = function (id){\n        return `https://api.furrynovel.ink/pixiv/series/${id}/cache`\n    }\n\n    u.urlUserUrl = function (id) {\n        return `https://furrynovel.ink/pixiv/user/${id}/cache`\n    }\n    u.urlUserDetailed = function (id) {\n        return `https://api.furrynovel.ink/pixiv/user/${id}/cache`\n    }\n    u.urlUsersDetailed = function (nidList) {\n        return `https://api.furrynovel.ink/pixiv/users/cache?${nidList.map(v => \"ids[]=\" + v).join(\"&\")}`\n    }\n\n    u.urlSearchNovel = function (novelname) {\n        return `https://api.furrynovel.ink/pixiv/search/novel/${novelname}/cache`\n    }\n    u.urlSearchUsers = function (username) {\n        return `https://api.furrynovel.ink/pixiv/search/user/${username}/cache`\n    }\n\n    u.urlCoverUrl = function (pxImgUrl) {\n        return `https://pximg.furrynovel.ink/?url=${pxImgUrl}&w=800`\n    }\n    u.urlIllustOriginal = function (illustId, order) {\n        // 使用 pixiv.cat 获取插图\n        let illustOriginal = `https://pixiv.re/${illustId}.png`\n        // let illustOriginal = `https://pixiv.nl/${illustId}.png`\n        if (order >= 1) {\n            illustOriginal = `https://pixiv.re/${illustId}-${order}.png`\n            // illustOriginal = `https://pixiv.nl/${illustId}-${order}.png`\n        }\n        return illustOriginal\n    }\n\n    u.formatNovels = function (novels) {\n        novels.forEach(novel => {\n            // novel.createDate = novel.createDate\n            novel.textCount = novel.length\n            novel.description = novel.desc\n            novel.detailedUrl = util.urlNovelDetailed(novel.id)\n            if (novel.seriesId !== undefined && novel.seriesId !== null) {\n                novel.title = novel.seriesTitle\n                novel.length = null\n\n                java.log(`正在获取系列小说：${novel.seriesId}`)\n                let series = util.getAjaxJson(util.urlSeriesDetailed(novel.seriesId))\n                // 后端目前没有系列的coverUrl字段\n                // novel.coverUrl = util.urlCoverUrl(series.coverUrl)\n                novel.coverUrl = util.urlCoverUrl(series.novels[0].coverUrl)\n\n                if (series.caption === \"\") {\n                    let firstNovels = util.getAjaxJson(util.urlNovelsDetailed([series.novels[0].id]))\n                    if (firstNovels.length > 0) {\n                        novel.description = firstNovels[0].desc\n                    } else {\n                        novel.description = \"该小说可能部分章节因为权限或者被删除无法查看\"\n                    }\n                } else {\n                    novel.description = series.caption\n                }\n\n                //如果没有标签 取第一章的tag\n                if (series.tags.length === 0) {\n                    // 系列至少会有一章\n                    novel.tags = series.novels[0].tags\n                } else {\n                    novel.tags = series.tags\n                }\n\n                if (novel.tags === undefined) {\n                    novel.tags = []\n                }\n                novel.tags.unshift(\"长篇\")\n\n\n            } else {\n                if (novel.tags === undefined) {\n                    novel.tags = []\n                }\n                novel.tags.unshift(\"单本\")\n                // novel.coverUrl = `https://api.furrynovel.ink/proxy/pximg?url=${novel.coverUrl}`\n                novel.coverUrl = util.urlCoverUrl(novel.coverUrl)\n            }\n\n            novel.tags = novel.tags.join(\",\")\n            novel.time = util.dateFormat(novel.createDate)\n            novel.description = `${novel.description}\\n更新时间：${novel.time}`\n            // novel.description = `书名：${novel.title}\\n作者：${novel.userName}\\n${novel.description}\\n更新时间：${novel.time}`\n        })\n        return novels\n    }\n    // 将多个长篇小说解析为一本书\n    u.combineNovels = function(novels) {\n        return novels.filter(novel => {\n            // 单本直接解析为一本书，需要判断是否为 null\n            if (novel.seriesId === undefined || novel.seriesId === null) {\n                return true\n            }\n            //集合中没有该系列解析为一本书\n            if (!seriesSet.has(novel.seriesId)) {\n                seriesSet.add(novel.seriesId)\n                return true\n            }\n            return false\n        })\n    }\n\n    u.dateFormat = function (str) {\n        let addZero = function (num) {\n            return num < 10 ? '0' + num : num;\n        }\n        let time = new Date(str);\n        let Y = time.getFullYear() + \"年\";\n        let M = addZero(time.getMonth() + 1) + \"月\";\n        let D = addZero(time.getDate()) + \"日\";\n        return Y + M + D;\n    }\n    u.timeStampFormat = function (int) {\n        let addZero = function (num) {\n            return num < 10 ? '0' + num : num;\n        }\n        let time = new Date(int * 1000);\n        let Y = time.getFullYear()\n        let M = addZero(time.getMonth() + 1)\n        let D = addZero(time.getDate())\n        let h = addZero(time.getHours())\n        let m = addZero(time.getMinutes())\n        let s = addZero(time.getSeconds())\n        return `${Y}-${M}-${D} ${h}:${m}:${s}`\n    }\n    u.timeTextFormat = function (text) {\n        if (text === undefined) {\n            return \"\"\n        }\n            return `${text.slice(0, 10)} ${text.slice(11, 19)}`\n    }\n\n    util = u\n    java.put(\"util\", objStringify(u))\n}\n\npublicFunc()\n\n// 获取请求的user id方便其他ajax请求构造\nlet uid = java.getResponse().headers().get(\"x-userid\")\nif (uid != null) {\n    cache.put(\"pixiv:uid\", uid)\n}\njava.getStrResponse(null, null)",
        "loginUrl": "",
        "respondTime": 180000,
        "ruleBookInfo": {
            "author": "userName",
            "canReName": "",
            "coverUrl": "coverUrl",
            "init": "@js:\nvar util = objParse(String(java.get(\"util\")))\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\n(function (res) {\n    // 处理详情页链接\n    let isHtml = res.startsWith(\"<!DOCTYPE html>\")\n    let id = baseUrl.match(new RegExp(\"\\\\d+\"))[0]\n    java.log(`当前小说ID：${id}`)\n    if (isHtml) {\n        let matchResult = baseUrl.match(new RegExp(\"pn|pixiv/novel|pixiv.net/novel\"))\n        if (matchResult == null) {\n            return []\n        }\n        res = util.getAjaxJson(util.urlNovelDetailed(id))\n    } else {\n        // 处理 json ，自搜索或 api 链接\n        res = JSON.parse(res)\n        if (res.error === true || res.total === 0) {\n            java.log(`Linpx 上暂无该小说(${id})，无法获取相关内容`)\n            return []\n        }\n    }\n\n\n    // 为了兼顾导入书架直接走详情页逻辑\n    // 这里不能直接用 book.xxx 来复用搜索页处理结果\n    // java.log(JSON.stringify(res))\n    let info = {}\n    info.userName = res.userName\n    info.tags = res.tags\n    info.textCount = res.length\n    info.description = res.desc\n    info.coverUrl = util.urlCoverUrl(res.coverUrl)\n\n    if (res.series === undefined || res.series === null) {\n        info.title = info.latest_chapter = res.title\n        info.tags.unshift('单本')\n        info.catalog = util.urlNovelDetailed(res.id)\n    } else {\n        info.title = res.series.title\n        info.tags.unshift('长篇')\n        info.catalog = util.urlSeriesDetailed(res.series.id)\n    }\n    info.tags = info.tags.join(\",\")\n    return info\n\n})(result)\n",
            "intro": "description",
            "kind": "tags",
            "lastChapter": "latestChapter",
            "name": "title",
            "tocUrl": "catalog",
            "wordCount": "textCount"
        },
        "ruleContent": {
            "content": "@js:\nvar util = objParse(String(java.get(\"util\")))\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\n(function (res) {\n    let isHtml = res.startsWith(\"<!DOCTYPE html>\")\n    let id = baseUrl.match(new RegExp(\"\\\\d+\"))[0]\n    java.log(`正文：当前小说ID：${id}`)\n    // 处理详情页链接\n    if (isHtml) {\n        let matchResult = baseUrl.match(new RegExp(\"pn|pixiv/novel|pixiv.net/novel\"))\n        if (matchResult == null) {\n            return []\n        }\n        res = util.getAjaxJson(util.urlNovelDetailed(id))\n    } else {\n        // 处理 json ，自搜索或 api 链接\n        res = JSON.parse(res)\n        if (res.error === true || res.total === 0) {\n            java.log(`Linpx 上暂无该小说(${id})，无法获取相关内容`)\n            return []\n        }\n    }\n\n    let content = res.content\n    if (res.series !== null && res.desc !== undefined && res.desc !== \"\") {\n        content = res.desc + \"\\n\" + \"——————————\\n\".repeat(2) + content\n    }\n\n    // 获取 [uploadedimage:] 的图片链接\n    // 将存在的 pixiv 图片链接替换为可访问的直连\n    if (res.images !== undefined && res.images !== null) {\n        Object.keys(res.images).forEach((key) => {\n            content = content.replace(`[uploadedimage:${key}]`, `<img src=\"${util.urlCoverUrl(res.images[key].origin)}\">`)\n        })\n    }\n\n    // 获取 [pixivimage:] 的图片链接 [pixivimage:1234] [pixivimage:1234-1]\n    let matched = content.match(RegExp(/\\[pixivimage:(\\d+)-?(\\d+)]/gm))\n    if (matched) {\n        for (let i in matched) {\n            let illustId, order\n            let matched2 = matched[i].match(RegExp(\"(\\\\d+)-?(\\\\d+)\"))\n            let temp = matched2[0].split(\"-\")\n            illustId = temp[0]\n            if (temp.length >= 2) {\n                order = temp[1]\n            }\n            content = content.replace(`${matched[i]}`, `<img src=\"${util.urlIllustOriginal(illustId, order)}\">`)\n        }\n    }\n\n    // 替换 Pixiv 分页标记符号 [newpage]\n    matched = content.match(RegExp(/[ 　]*\\[newpage][ 　]*/gm))\n    if (matched) {\n        for (let i in matched){\n            java.log(matched[i])\n            content = content.replace(`${matched[i]}`, `${\"<p>​<p/>\".repeat(3)}`)\n        }\n    }\n\n    // 替换 Pixiv 章节标记符号 [chapter:]\n    matched = content.match(RegExp(/\\[chapter:(.*?)]/gm))\n    if (matched) {\n        for (let i in matched) {\n            let matched2 = matched[i].match(/\\[chapter:(.*?)]/m)\n            let chapter = matched2[1].trim()\n            content = content.replace(`${matched[i]}`, `${chapter}<p>​<p/>`)\n        }\n    }\n\n    // 替换 Pixiv 跳转页面标记符号 [[jump:]]\n    matched = content.match(RegExp(/\\[jump:(\\d+)]/gm))\n    if (matched) {\n        for (let i in matched) {\n            let page = matched[i].match(/\\d+/)\n            content = content.replace(`${matched[i]}`, `\\n\\n跳转至第${page}节`)\n        }\n    }\n\n    // 替换 Pixiv 链接标记符号 [[jumpuri: > ]]\n    matched = content.match(RegExp(/\\[\\[jumpuri:(.*?)>(.*?)]]/gm))\n    if (matched) {\n        for (let i in matched) {\n            let matched2 = matched[i].match(/\\[\\[jumpuri:(.*?)>(.*?)]]/m)\n            let matchedText = matched2[0]\n            let urlName = matched2[1].trim()\n            let urlLink = matched2[2].trim()\n            // 阅读不支持超链接\n            // content = content.replace(`${matchedText}`, `<a href=${urlLink}>${urlName}</a>`)\n            if (urlLink === urlName) {\n                content = content.replace(`${matchedText}`, `${urlName}`)\n            } else {\n                content = content.replace(`${matchedText}`, `${urlName}: ${urlLink}`)\n            }\n        }\n    }\n\n    // 替换 Pixiv 注音标记符号 [[rb: > ]]\n    matched = content.match(RegExp(/\\[\\[rb:(.*?)>(.*?)]]/gm))\n    if (matched) {\n        for (let i in matched) {\n            let matched2 = matched[i].match(/\\[\\[rb:(.*?)>(.*?)]]/m)\n            let matchedText = matched2[0]\n            let kanji = matched2[1].trim()\n            let kana = matched2[2].trim()\n\n            if (util.REPLACE_WITH_BOOK_TITLE_MARKS === true) {\n                // 默认替换成（括号）\n                content = content.replace(`${matchedText}`, `${kanji}（${kana}）`)\n            } else {\n                var reg = new RegExp(\"[\\\\u4E00-\\\\u9FFF]+\",\"g\");\n                if (reg.test(kana)) {\n                    // kana为中文，则替换回《书名号》\n                    content = content.replace(`${matchedText}`, `${kanji}《${kana}》`)\n                } else{\n                    // 阅读不支持 <ruby> <rt> 注音\n                    // content = content.replace(`${matchedText}`, `<ruby>${kanji}<rt>${kana}</rt></ruby>`)\n                    content = content.replace(`${matchedText}`, `${kanji}（${kana}）`)\n                }\n            }\n        }\n    }\n\n    return content\n})(result)",
            "imageStyle": "DEFAULT",
            "replaceRegex": "",
            "sourceRegex": ""
        },
        "ruleExplore": {
            "author": "userName",
            "bookList": "@js:\nvar util = objParse(String(java.get(\"util\")))\nvar seriesSet = new Set();  // 存储seriesID\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\n\n/**\n * @params arr 传入的源数组\n * @params length 需要获取的元素的个数\n */\nfunction randomChoseArrayItem(arr, length) {\n    let copyArr = JSON.parse(JSON.stringify(arr))\n    let newArr = [];\n    for (let i = 0; i < length; i++) {\n        let index = Math.floor(Math.random() * copyArr.length);\n        let item = copyArr[index];\n        newArr.push(item)\n        copyArr.splice(index, 1)\n    }\n    return newArr.reverse()\n}\n\n\nfunction handlerRecommendUsers() {\n    const MAX_FETCH_USER_NUMBER = 2;\n\n    return () => {\n        let userIds = JSON.parse(result).map(i => i.id)\n        // java.log(`用户id个数:${userIds.length}`)\n        if (userIds.length > MAX_FETCH_USER_NUMBER) {\n            userIds = randomChoseArrayItem(userIds, MAX_FETCH_USER_NUMBER);\n        }\n        // java.log(`查询的用户Ids:${userIds}`)\n        let usersInfo = util.getWebviewJson(util.urlUsersDetailed(userIds))\n        // java.log(`返回的${JSON.stringify(usersInfo)}`)\n        let queryNovelIds = []\n        // java.log(`${JSON.stringify(usersInfo)}`)\n        usersInfo.filter(user => user.novels && user.novels.length > 0)\n            .map(user => user.novels)\n            // 将list展平[1,2,3]变为1,2,3 添加到novelList中\n            .forEach(novels => {\n                novels.forEach(novel => {\n                    queryNovelIds.push(novel)\n                })\n            })\n        // 暂时限制最大获取数量\n        if (queryNovelIds.length > 10) {\n            queryNovelIds = randomChoseArrayItem(queryNovelIds, 10)\n        }\n        novelList = util.getWebviewJson(util.urlNovelsDetailed(queryNovelIds))\n        return util.formatNovels(util.combineNovels(novelList))\n    }\n}\n\nfunction handlerFollowLatest() {\n    return () => {\n        let resp = JSON.parse(result)\n        return util.formatNovels(util.combineNovels(resp))\n    }\n}\n\nfunction handlerFactory() {\n    if (baseUrl.indexOf(\"/fav/user\") !== -1) {\n        return handlerRecommendUsers()\n    }\n\n    if (baseUrl.indexOf(\"/pixiv/novels/recent\") !== -1) {\n        return handlerFollowLatest()\n    }\n\n}\n\n(() => {\n    return handlerFactory()()\n})()\n",
            "bookUrl": "detailedUrl",
            "coverUrl": "coverUrl",
            "intro": "description",
            "kind": "tags",
            "lastChapter": "latestChapter",
            "name": "title",
            "wordCount": "textCount"
        },
        "ruleSearch": {
            "author": "userName",
            "bookList": "@js:\nvar util = objParse(String(java.get(\"util\")))\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\n\nfunction getUser(username, exactMatch) {\n    // 修复传入object的bug\n    username = String(username)\n    let resp = util.getAjaxJson(util.urlSearchUsers(username))\n    if (resp.users.length === 0) {\n        return []\n    }\n    if (!exactMatch) {\n        return resp.users\n    }\n    // 只返回用户名完全一样的用户\n    return resp.users.filter(user => {\n        return user.name === username\n    })\n}\n\n// 包含所有小说数据\nfunction getUserDetailedList(uidList) {\n    // java.log(`UIDLIST:${JSON.stringify(uidList)}`)\n    return util.getWebviewJson(util.urlUsersDetailed(uidList))\n}\n\nfunction getNovels(nidList) {\n    let page = Number(java.get(\"page\"))\n    // 分页\n    let list = nidList.slice((page - 1) * 20, page * 20)\n    if (list.length === 0) {\n        return []\n    }\n    // java.log(`NIDURL:${util.urlNovelsDetailed(list)}`)\n    return util.getWebviewJson(util.urlNovelsDetailed(list))\n}\n\n// 存储seriesID\nvar first = true;\nvar seriesSet = {\n    keywords: \"Linpx:Search\",\n    has: (value) => {\n        let page = Number(java.get(\"page\"))\n        if (page === 1 && first) {\n            first = false\n            cache.deleteMemory(this.keywords)\n            return false\n        }\n\n        let v = cache.getFromMemory(this.keywords)\n        if (v === undefined || v === null) {\n            return false\n        }\n        let set = new Set(JSON.parse(v))\n        return set.has(value)\n    },\n\n    add: (value) => {\n        let v = cache.getFromMemory(this.keywords)\n        if (v === undefined || v === null) {\n            cache.putMemory(this.keywords, JSON.stringify([value]))\n\n        } else {\n            let arr = JSON.parse(v)\n            if (typeof arr === \"string\") {\n                arr = Array(arr)\n            }\n            arr.push(value)\n            cache.putMemory(this.keywords, JSON.stringify(arr))\n        }\n    },\n};\n\n\nfunction findUserNovels(username) {\n    let novelList = []\n    // 查询用户\n    let userArr = getUser(username, true)\n    // 获取用户所有小说\n    let uidList = userArr.filter(user => {\n        return user.novels.length > 0\n    }).map(user => user.id)\n\n    if (uidList.length > 0) {\n        let list = getUserDetailedList(uidList)\n        let nidList = []\n        // 从两层数组中提取novelsId\n        list.forEach(user => {\n            user.novels\n                // 按id降序排序-相当于按时间降序排序\n                .reverse()\n                .forEach(nid => nidList.push(nid))\n        })\n        getNovels(nidList).forEach(novel => {\n            novelList.push(novel)\n        })\n    }\n    return novelList\n}\n\n(function (res) {\n    res = JSON.parse(res)\n    let novels = []\n    findUserNovels(java.get(\"key\")).forEach(v => {\n        novels.push(v)\n    })\n    novels = novels.concat(res.novels)\n    // 返回空列表中止流程\n    if (novels.length === 0) {\n        return []\n    }\n    return util.formatNovels(util.combineNovels(novels))\n}(result))",
            "bookUrl": "detailedUrl",
            "checkKeyWord": "测试页面",
            "coverUrl": "coverUrl",
            "intro": "description",
            "kind": "tags",
            "lastChapter": "latestChapter",
            "name": "title",
            "wordCount": "textCount"
        },
        "ruleToc": {
            "chapterList": "@js:\nvar util = objParse(String(java.get(\"util\")))\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\nfunction oneShotHandler(res) {\n    return [{\n        title: res.title,\n        chapterUrl: util.urlNovel(res.id),\n        updateDate: util.timeTextFormat(res.createDate)\n    }]\n}\n\nfunction seriesHandler(res) {\n    res.novels.forEach(v => {\n        // v.title = v.title\n        v.chapterUrl = util.urlNovel(v.id)\n        // v.updateDate = String(v.coverUrl.match(RegExp(\"\\\\d{4}/\\\\d{2}/\\\\d{2}\")))  //fake\n        v.updateDate = util.timeTextFormat(util.getAjaxJson(util.urlNovelDetailed(v.id)).createDate)\n    })\n    return res.novels\n}\n\n(function (res) {\n    // 获取网址id，请求并解析数据，调试用\n    let isHtml = res.startsWith(\"<!DOCTYPE html>\")\n    let id = baseUrl.match(new RegExp(\"\\\\d+\"))[0]\n    if (isHtml) {\n        let matchResult = baseUrl.match(new RegExp(\"pn|pixiv/novel|pixiv.net/novel\"))\n        if (matchResult == null) {\n            return []\n        }\n        res = util.getAjaxJson(util.urlNovelDetailed(id))\n        java.log(`目录：当前小说ID：${id}`)\n        if (res.series !== undefined) {\n            java.log(`目录：当前系列ID：${res.series.id}${res.series.title}`)\n            res = util.getAjaxJson(util.urlSeriesDetailed(res.series.id))\n        }\n    } else {\n        res = JSON.parse(res)\n        if (res.error === true || res.total === 0) {\n            java.log(`Linpx 上暂无该小说(${id})，无法获取相关内容`)\n            return []\n        }\n    }\n\n    if (res.novels === undefined) {\n        return oneShotHandler(res)\n    }\n    return seriesHandler(res)\n})(result)\n",
            "chapterName": "title",
            "chapterUrl": "chapterUrl",
            "updateTime": "updateDate"
        },
        "searchUrl": "@js:\njava.put(\"page\",page);java.put(\"key\",key);\n`https://api.furrynovel.ink/pixiv/search/novel/${encodeURI(key)}/cache?page=${page}`;",
        "variableComment": "",
        "weight": 0
    }
]