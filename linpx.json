[
    {
        "bookSourceComment": "Linpx ä¹¦æºï¼ˆå•ç¯‡ï¼‰ï¼ˆæ›´æ–°ğŸ“†ï¼š2024-01-31ï¼‰\n\nå¯ç”¨åŠŸèƒ½ï¼šâœ…æœç´¢âœ…å‘ç°âœ…æ·»åŠ ç½‘å€âœ…è®¢é˜…æº  \næœç´¢å°è¯´ï¼šâœ…å•ç¯‡âŒç³»åˆ—âœ…ä½œè€…âœ…æ ‡ç­¾âœ…é“¾æ¥  \nå‘ç°å°è¯´ï¼šâœ…æ¨èä½œè€…âœ…æœ€è¿‘æ›´æ–°  \næ·»åŠ ç½‘å€ï¼šâœ…Linpx é“¾æ¥âœ…Linpx åˆ†äº«é“¾æ¥  \næœç´¢ç½‘å€ï¼šâœ…Linpx é“¾æ¥âœ…Pixiv åŸæ–‡é“¾æ¥  \nè®¢é˜…ç”¨æ³•ï¼šç‚¹å‡»è®¢é˜…æºæ‰“å¼€å°è¯´ï¼Œç‚¹å‡»ã€æ·»åŠ åˆ°ä¹¦æ¶ã€‘æŒ‰é’®æ·»åŠ å°è¯´åˆ°ä¹¦æ¶  \næ¸©é¦¨æç¤ºï¼šâš ï¸Linpx æœç´¢æš‚æ—¶ä¸æ”¯æŒç³»åˆ—å°è¯´åç§°ï¼Œæ·»åŠ ç³»åˆ—å°è¯´åï¼Œæ— æ³•å†æ¬¡é€šè¿‡æœç´¢è·å–å¹¶æ›´æ–°ç›®å½•\n\nä¹¦æºå‘å¸ƒï¼šå…½äººé˜…è¯»é¢‘é“ https://t.me/FurryReading  \né¡¹ç›®åœ°å€ï¼šhttps://github.com/windyhusky/PixivSource  \nä½¿ç”¨æ•™ç¨‹ï¼šhttps://github.com/windyhusky/PixivSource/blob/main/doc/Linpx.md\n\nè§„åˆ™è®¢é˜…ï¼šImport è®¢é˜…æº\nhttps://cdn.jsdelivr.net/gh/windyhusky/PixivSource@main/import.json\nhttps://raw.githubusercontent.com/windyhusky/PixivSource/main/import.json\n\nâš™ï¸ ä¹¦æºè®¾ç½®ï¼š\nä¹¦æºç®¡ç† - ç¼–è¾‘ä¹¦æº - åŸºæœ¬ - å˜é‡è¯´æ˜ - ä¿®æ”¹å¹¶ä¿å­˜",
        "bookSourceGroup": "ğŸ” Pixiv",
        "bookSourceName": "Linpx",
        "bookSourceType": 0,
        "bookSourceUrl": "https://furrynovel.ink",
        "bookUrlPattern": ".*(https?://)?(api\\.|www\\.)?(furrynovel\\.(ink|xyz))/(pn|pixiv/novel)/\\d+(/cache)?.*",
        "customOrder": 2,
        "enabled": true,
        "enabledCookieJar": false,
        "enabledExplore": true,
        "exploreUrl": "@js:\nli = [\n    {\"æ¨èä½œè€…\": \"https://api.furrynovel.ink/fav/user/cache\"},\n    {\"æœ€æ–°å°è¯´\": \"https://api.furrynovel.ink/pixiv/novels/recent/cache?page={{page}}\"}\n]\n\n// æ ¼å¼åŒ–å‘ç°åœ°å€\nli.forEach(item => {\n    item.title = Object.keys(item)[0]\n    item.url = Object.values(item)[0]\n    delete item[Object.keys(item)[0]]\n    item.style = {}\n    item.style.layout_flexGrow = 1\n    item.style.layout_flexBasisPercent = 0.15\n})\nJSON.stringify(li)",
        "header": "{\"referer\":\"https://furrynovel.ink/\"}",
        "lastUpdateTime": 1738252800251,
        "loginCheckJs": "var util = {}\n\nfunction objStringify(obj) {\n    return JSON.stringify(obj, (n, v) => {\n        if (typeof v == \"function\")\n            return v.toString();\n        return v;\n    });\n}\n\nfunction publicFunc() {\n    let u = {}, settings = {}\n    java.log(String(source.bookSourceComment).split(\"\\n\")[0]) // è¾“å‡ºä¹¦æºä¿¡æ¯\n    java.log(`æ‰‹åŠ¨æ›´æ–°æ—¶é—´ï¼š${java.timeFormat(source.lastUpdateTime)}`) // è¾“å‡ºä¹¦æºä¿¡æ¯\n    try {\n        settings = String(source.variableComment).match(RegExp(/{([\\s\\S]*?)}/gm))\n        java.log(\"âš™ï¸ ä½¿ç”¨è‡ªå®šä¹‰è®¾ç½®\")\n    } catch (e) {\n        settings.SHOW_ORIGINAL_NOVEL_LINK = true\n        settings.REPLACE_BOOK_TITLE_MARKS = true\n        settings.MORE_INFO_IN_DESCRIPTION = false\n        settings.DEBUG = false\n        java.log(\"âš™ï¸ ä½¿ç”¨é»˜è®¤è®¾ç½®ï¼ˆæ— è‡ªå®šä¹‰è®¾ç½® æˆ– è‡ªå®šä¹‰è®¾ç½®æœ‰è¯¯ï¼‰\")\n    } finally {\n        u.SHOW_ORIGINAL_NOVEL_LINK = settings.SHOW_ORIGINAL_NOVEL_LINK  // ç›®å½•å¤„æ˜¾ç¤ºå°è¯´æºé“¾æ¥ï¼Œä½†ä¼šå¢åŠ è¯·æ±‚æ¬¡æ•°\n        u.REPLACE_BOOK_TITLE_MARKS = settings.REPLACE_BOOK_TITLE_MARKS  // æ³¨éŸ³å†…å®¹ä¸ºæ±‰å­—æ—¶ï¼Œæ›¿æ¢ä¸ºä¹¦åå·\n        u.MORE_INFO_IN_DESCRIPTION = settings.MORE_INFO_IN_DESCRIPTION  // ä¹¦ç±ç®€ä»‹æ˜¾ç¤ºæ›´å¤šä¿¡æ¯\n        u.DEBUG = settings.DEBUG // è°ƒè¯•æ¨¡å¼\n    }\n\n    if (u.DEBUG === true) {\n        // java.log(JSON.stringify(settings))\n        // java.log(`SHOW_ORIGINAL_NOVEL_LINK = ${u.SHOW_ORIGINAL_NOVEL_LINK}`)\n        // java.log(`REPLACE_BOOK_TITLE_MARKS = ${u.REPLACE_BOOK_TITLE_MARKS}`)\n        // java.log(`MORE_INFO_IN_DESCRIPTION = ${u.MORE_INFO_IN_DESCRIPTION}`)\n        java.log(`DEBUG = ${u.DEBUG}`)\n    }\n\n\n    u.debugFunc = (func) => {\n        if (util.DEBUG) {\n            func()\n        }\n    }\n    u.cacheGetAndSet = (key, supplyFunc) => {\n        let v = cache.get(key)\n        if (v === undefined || v === null) {\n            v = JSON.stringify(supplyFunc())\n            // ç¼“å­˜10åˆ†é’Ÿ\n            cache.put(key, v, 600)\n        }\n        return JSON.parse(v)\n    }\n    u.getAjaxJson = (url) => {\n        return util.cacheGetAndSet(url, () => {\n            return JSON.parse(java.ajax(url))\n        })\n    }\n    u.getWebviewJson = (url) => {\n        return util.cacheGetAndSet(url, () => {\n            let html = java.webView(null, url, null)\n            return JSON.parse((html.match(new RegExp(\">\\\\[{.*?}]<\"))[0].replace(\">\", \"\").replace(\"<\", \"\")))\n        })\n    }\n\n    u.urlNovelUrl = (novelId) => {\n        return `https://furrynovel.ink/pixiv/novel/${novelId}/cache`\n    }\n    u.urlNovelDetailed = (novelId) => {\n        return `https://api.furrynovel.ink/pixiv/novel/${novelId}/cache`\n    }\n    u.urlNovelsDetailed = (nidList) => {\n        return `https://api.furrynovel.ink/pixiv/novels/cache?${nidList.map(v => \"ids[]=\" + v).join(\"&\")}`\n    }\n    u.urlNovelComments = (novelId) => {\n        return `https://api.furrynovel.ink/pixiv/novel/${novelId}/comments`\n    }\n    u.urlNovel = (novelId) => {\n        if (util.SHOW_ORIGINAL_NOVEL_LINK) {\n            return util.urlNovelUrl(novelId)\n        } else {\n            return util.urlNovelDetailed(novelId)\n        }\n    }\n\n    // u.urlSeriesUrl = function (id) {\n    //     return `https://furrynovel.ink/pixiv/series/${id}/cache`\n    // }\n    u.urlSeriesUrl = (seriesId) => {\n        return `https://www.pixiv.net/novel/series/${seriesId}`\n    }\n    u.urlSeriesDetailed = (seriesId) => {\n        return `https://api.furrynovel.ink/pixiv/series/${seriesId}/cache`\n    }\n    u.urlSeries = (seriesId) => {\n        if (util.SHOW_ORIGINAL_NOVEL_LINK) {\n            return util.urlSeriesUrl(seriesId)\n        } else {\n            return util.urlSeriesDetailed(seriesId)\n        }\n    }\n\n    u.urlUserUrl = (userId) => {\n        return `https://furrynovel.ink/pixiv/user/${userId}/cache`\n    }\n    u.urlUserDetailed = (userId) => {\n        return `https://api.furrynovel.ink/pixiv/user/${userId}/cache`\n    }\n    u.urlUsersDetailed = (uidList) => {\n        return `https://api.furrynovel.ink/pixiv/users/cache?${uidList.map(v => \"ids[]=\" + v).join(\"&\")}`\n    }\n\n    u.urlSearchNovel = (novelName) => {\n        return `https://api.furrynovel.ink/pixiv/search/novel/${novelName}/cache`\n    }\n    u.urlSearchUsers = (userName) => {\n        return `https://api.furrynovel.ink/pixiv/search/user/${userName}/cache`\n    }\n\n    u.urlCoverUrl = (pxImgUrl) => {\n        return `https://pximg.furrynovel.ink/?url=${pxImgUrl}&w=800`\n    }\n    // u.urlIllustUrl = function (illustId) {\n    //     return `https://www.pixiv.net/artworks/${illustId}`\n    // }\n    u.urlIllustOriginal = (illustId, order) => {\n        // ä½¿ç”¨ pixiv.cat è·å–æ’å›¾\n        let illustOriginal = `https://pixiv.re/${illustId}.png`\n        // let illustOriginal = `https://pixiv.nl/${illustId}.png`\n        if (order >= 1) {\n            illustOriginal = `https://pixiv.re/${illustId}-${order}.png`\n            // illustOriginal = `https://pixiv.nl/${illustId}-${order}.png`\n        }\n        return illustOriginal\n    }\n\n    // å°†å¤šä¸ªé•¿ç¯‡å°è¯´è§£æä¸ºä¸€æœ¬ä¹¦\n    u.combineNovels = function(novels) {\n        return novels.filter(novel => {\n            // å•æœ¬ç›´æ¥è§£æä¸ºä¸€æœ¬ä¹¦ï¼Œéœ€è¦åˆ¤æ–­æ˜¯å¦ä¸º null\n            if (novel.seriesId === undefined || novel.seriesId === null) {\n                return true\n            }\n            //é›†åˆä¸­æ²¡æœ‰è¯¥ç³»åˆ—è§£æä¸ºä¸€æœ¬ä¹¦\n            if (!seriesSet.has(novel.seriesId)) {\n                seriesSet.add(novel.seriesId)\n                return true\n            }\n            return false\n        })\n    }\n\n    // å¤„ç† novels åˆ—è¡¨\n    u.handNovels = function (novels){\n        novels.forEach(novel => {\n            if (novel.tags === undefined) {\n                novel.tags = []\n            }\n            // novel.id = novel.id\n            // novel.title = novel.title\n            // novel.userName = novel.userName\n            if (novel.seriesId === undefined || novel.seriesId === null) {\n                // novel.tags = novel.tags\n                novel.tags.unshift(\"å•æœ¬\")\n                novel.textCount = novel.length\n                novel.latestChapter = novel.title\n                novel.description = novel.desc\n                // novel.coverUrl = novel.coverUrl\n                novel.detailedUrl = util.urlNovel(novel.id)\n\n            } else {\n                java.log(`æ­£åœ¨è·å–ç³»åˆ—å°è¯´ï¼š${novel.seriesId}`)\n                let series = util.getAjaxJson(util.urlSeriesDetailed(novel.seriesId))\n                novel.id = series.novels[0].id\n                novel.title = novel.seriesTitle\n                novel.tags = series.tags\n                // novel.tags = novel.tags.concat(series.tags)\n                novel.tags = novel.tags.concat(series.novels[0].tags)\n                novel.tags.unshift(\"é•¿ç¯‡\")\n                novel.tags = Array.from(new Set(novel.tags))\n                novel.textCount = null  // æ— æ•°æ®\n                novel.createDate = null  // æ— æ•°æ®\n                novel.latestChapter = series.novels[series.novels.length-1].title\n                novel.description = series.caption\n                // åç«¯ç›®å‰æ²¡æœ‰ç³»åˆ—çš„ coverUrl å­—æ®µ\n                // novel.coverUrl = series.coverUrl\n                novel.coverUrl = series.novels[0].coverUrl\n                novel.detailedUrl = util.urlNovel(novel.id)\n                // novel.detailedUrl = util.urlSeries(novel.id)\n\n                if (series.caption === \"\") {\n                    let firstNovel = util.getAjaxJson(util.urlNovelDetailed(novel.id))\n                    novel.createDate = firstNovel.createDate\n                    if (firstNovel.length > 0) {\n                        novel.description = firstNovel[0].desc\n                    } else {\n                        novel.description = \"è¯¥å°è¯´å¯èƒ½éƒ¨åˆ†ç« èŠ‚å› ä¸ºæƒé™æˆ–è€…è¢«åˆ é™¤æ— æ³•æŸ¥çœ‹\"\n                    }\n                }\n            }\n        })\n        return novels\n    }\n\n    // å°è¯´ä¿¡æ¯æ ¼å¼åŒ–\n    u.formatNovels = function (novels) {\n        novels.forEach(novel => {\n            novel.title = novel.title.replace(RegExp(/^\\s+|\\s+$/g), \"\")\n            novel.tags = novel.tags.join(\",\")\n            novel.coverUrl = util.urlCoverUrl(novel.coverUrl)\n            // novel.readingTime = `${novel.readingTime / 60} åˆ†é’Ÿ`\n            novel.createDate = util.dateFormat(novel.createDate);\n            // novel.updateDate = this.dateFormat(novel.updateDate);\n            if (util.MORE_INFO_IN_DESCRIPTION) {\n                novel.description = `\\nä¹¦åï¼š${novel.title}\\nä½œè€…ï¼š${novel.userName}\\næ ‡ç­¾ï¼š${novel.tags}\\nä¸Šä¼ ï¼š${novel.createDate}\\nç®€ä»‹ï¼š${novel.description}`\n            } else {\n                novel.description = `\\n${novel.description}\\nä¸Šä¼ æ—¶é—´ï¼š${novel.createDate}`\n            }\n        })\n        return novels\n    }\n\n    // ä»ç½‘å€è·å–idï¼Œè¿”å›å•ç¯‡å°è¯´ resï¼Œç³»åˆ—è¿”å›é¦–ç¯‡å°è¯´ res\n    u.getNovelRes = function (result) {\n        let novelId = 0, res = {}\n        // å…¼å®¹æœç´¢ç›´æ¥è¾“å…¥é“¾æ¥\n        pattern = \"(https?://)?(api\\\\.|www\\\\.)?((furrynovel\\\\.(ink|xyz))|pixiv\\\\.net)(/ajax)?/(pn|(pixiv/)?novel)/(show\\\\.php\\\\?id=|series/)?\\\\d+(/cache)?\"\n        // pattern = String(bookSourceUrl).replace(\".*\", \"\")\n        if (RegExp(pattern).test(result) && !(result.startsWith(\"<!DOCTYPE html>\"))) {\n            baseUrl = result.match(RegExp(pattern))[0]\n            result = \"<!DOCTYPE html>\"\n            java.log(`åŒ¹é…é“¾æ¥ï¼š${baseUrl}`)\n        }\n\n        let isHtml = result.startsWith(\"<!DOCTYPE html>\")\n        if (isHtml) {\n            let id = baseUrl.match(new RegExp(\"\\\\d+\"))[0]\n            let pattern = \"(https?://)?(www\\\\.)?pixiv\\\\.net(/ajax)?/novel/(series/)?\\\\d+\"\n            let isSeries = baseUrl.match(new RegExp(pattern))\n            if (isSeries) {\n                java.log(`ç³»åˆ—IDï¼š${id}`)\n                res = util.getAjaxJson(util.urlSeriesDetailed(id))\n            } else {\n                let pattern = \"((furrynovel\\\\.(ink|xyz))|pixiv\\\\.net)/(pn|(pixiv/)?novel)/(show\\\\.php\\\\?id=)?\\\\d+\"\n                let isNovel = baseUrl.match(new RegExp(pattern))\n                if (isNovel) {\n                    novelId = id\n                }\n            }\n        } else {\n            res = JSON.parse(result)\n        }\n        if (res.total !== undefined && res.total !== null) {\n            novelId = res.novels[0].id\n        }\n        if (novelId) {\n            java.log(`åŒ¹é…å°è¯´IDï¼š${novelId}`)\n            res = util.getAjaxJson(util.urlNovelDetailed(novelId))\n        }\n        if (res.error) {\n            java.log(`æ— æ³•ä» Linpx è·å–å½“å‰å°è¯´`)\n            java.log(JSON.stringify(res))\n            return []\n        }\n        return res\n    }\n\n    // ä»ç½‘å€è·å–idï¼Œå°½å¯èƒ½è¿”å›ç³»åˆ— resï¼Œå•ç¯‡å°è¯´è¿”å›å°è¯´ res\n    u.getNovelResSeries = function (result) {\n        let seriesId = 0, res = {}\n        let isHtml = result.startsWith(\"<!DOCTYPE html>\")\n        if (isHtml) {\n            let id = baseUrl.match(new RegExp(\"\\\\d+\"))[0]\n            let pattern = \"(https?://)?(www\\\\.)?pixiv\\\\.net(/ajax)?/novel/(series/)?\\\\d+\"\n            let isSeries = baseUrl.match(new RegExp(pattern))\n            if (isSeries) {\n                seriesId = id\n            } else {\n                let pattern = \"((furrynovel\\\\.(ink|xyz))|pixiv\\\\.net)/(pn|(pixiv/)?novel)/(show\\\\.php\\\\?id=)?\\\\d+\"\n                let isNovel = baseUrl.match(new RegExp(pattern))\n                if (isNovel) {\n                    java.log(`åŒ¹é…å°è¯´IDï¼š${id}`)\n                    res = util.getAjaxJson(util.urlNovelDetailed(id))\n                }\n            }\n        } else {\n            res = JSON.parse(result)\n        }\n        if (res.series !== undefined && res.series !== null) {\n            seriesId = res.series.id\n        }\n        if (seriesId) {\n            java.log(`ç³»åˆ—IDï¼š${seriesId}`)\n            res = util.getAjaxJson(util.urlSeriesDetailed(seriesId))\n        }\n        if (res.error) {\n            java.log(`æ— æ³•ä» Linpx è·å–å½“å‰å°è¯´`)\n            java.log(JSON.stringify(res))\n            return []\n        }\n        return res\n    }\n\n    u.dateFormat = function (str) {\n        let addZero = function (num) {\n            return num < 10 ? '0' + num : num;\n        }\n        let time = new Date(str);\n        let Y = time.getFullYear() + \"å¹´\";\n        let M = addZero(time.getMonth() + 1) + \"æœˆ\";\n        let D = addZero(time.getDate()) + \"æ—¥\";\n        return Y + M + D;\n    }\n    u.timeTextFormat = function (text) {\n        if (text === undefined) {\n            return \"\"\n        }\n        return `${text.slice(0, 10)} ${text.slice(11, 19)}`\n    }\n\n    util = u\n    java.put(\"util\", objStringify(u))\n}\n\npublicFunc()\njava.getStrResponse(null, null)",
        "loginUrl": "",
        "respondTime": 180000,
        "ruleBookInfo": {
            "author": "userName",
            "canReName": "true",
            "coverUrl": "coverUrl",
            "init": "@js:\nvar util = objParse(String(java.get(\"util\")))\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\nfunction novelHandler(res){\n    let info = {}\n    info.novelId = res.id\n    info.title = res.title.replace(RegExp(/^\\s+|\\s+$/g), \"\")\n    info.userName = res.userName\n    info.tags = res.tags\n    info.textCount = res.length\n    info.description = res.desc\n    info.coverUrl = util.urlCoverUrl(res.coverUrl)\n    // info.catalogUrl = util.urlNovelDetailed(res.id)\n    info.createDate = util.timeTextFormat(res.createDate)\n\n    if (res.series === undefined || res.series === null) {\n        info.title = info.latestChapter = info.title\n        info.tags.unshift('å•æœ¬')\n        info.detailedUrl = util.urlNovelUrl(info.novelId)\n        info.catalogUrl = util.urlNovelDetailed(info.novelId)\n    } else {\n        info.seriesId = res.series.id\n        info.title = res.series.title.replace(RegExp(/^\\s+|\\s+$/g), \"\")\n        info.tags.unshift('é•¿ç¯‡')\n        info.detailedUrl = util.urlSeriesUrl(info.seriesId)\n        info.catalogUrl = util.urlSeriesDetailed(info.seriesId)\n\n        let res2 = util.getAjaxJson(util.urlSeriesDetailed(info.seriesId))\n        info.tags = info.tags.concat(res2.tags)   //åˆå¹¶ç³»åˆ— tags\n        info.tags = Array.from(new Set(info.tags))\n        info.description = `${res2.caption}\\nå½“å‰ç« èŠ‚ç®€ä»‹ï¼š\\n${info.description}`\n    }\n    info.tags = info.tags.join(\",\")\n    if (util.MORE_INFO_IN_DESCRIPTION) {\n        info.description = `\\nä¹¦åï¼š${info.title}\\nä½œè€…ï¼š${info.userName}\\næ ‡ç­¾ï¼š${info.tags}\\nä¸Šä¼ ï¼š${info.createDate}\\nç®€ä»‹ï¼š${info.description}`\n    } else {\n        info.description = `\\n${info.description}\\nä¸Šä¼ æ—¶é—´ï¼š${info.createDate}`\n    }\n    return info\n}\n\n(function (res) {\n    // ä¸ºäº†å…¼é¡¾å¯¼å…¥ä¹¦æ¶ç›´æ¥èµ°è¯¦æƒ…é¡µé€»è¾‘ï¼Œä¸èƒ½ç›´æ¥ç”¨ book.xxx æ¥å¤ç”¨æœç´¢é¡µå¤„ç†ç»“æœ\n    res = util.getNovelRes(result)  // ç³»åˆ—æ•°æ®è¿‡å°‘ï¼Œæš‚ä¸åˆ†æµ\n    try {\n        return novelHandler(res)\n    }catch (e) {\n        java.log(e)\n        java.log(`å— Linpx çš„é™åˆ¶ï¼Œæ— æ³•è·å–å½“å‰å°è¯´çš„æ•°æ®`)\n    }\n})(result)\n",
            "intro": "description",
            "kind": "tags",
            "lastChapter": "latestChapter",
            "name": "title",
            "tocUrl": "catalogUrl",
            "wordCount": "textCount"
        },
        "ruleContent": {
            "content": "@js:\nvar util = objParse(String(java.get(\"util\")))\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\n(function (res) {\n    res = util.getNovelRes(result)\n    let content = res.content\n    if (res.desc !== \"\") {\n        content = res.desc + \"\\n\" + \"â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\\n\".repeat(2) + content\n    }\n\n    // è·å– [uploadedimage:] çš„å›¾ç‰‡é“¾æ¥\n    // å°†å­˜åœ¨çš„ pixiv å›¾ç‰‡é“¾æ¥æ›¿æ¢ä¸ºå¯è®¿é—®çš„ç›´è¿\n    if (res.images !== undefined && res.images !== null) {\n        Object.keys(res.images).forEach((key) => {\n            content = content.replace(`[uploadedimage:${key}]`, `<img src=\"${util.urlCoverUrl(res.images[key].origin)}\">`)\n        })\n    }\n\n    // è·å– [pixivimage:] çš„å›¾ç‰‡é“¾æ¥ [pixivimage:1234] [pixivimage:1234-1]\n    let matched = content.match(RegExp(/\\[pixivimage:(\\d+)-?(\\d+)]/gm))\n    if (matched) {\n        for (let i in matched) {\n            let illustId, order\n            let matched2 = matched[i].match(RegExp(\"(\\\\d+)-?(\\\\d+)\"))\n            let temp = matched2[0].split(\"-\")\n            illustId = temp[0]\n            if (temp.length >= 2) {\n                order = temp[1]\n            }\n            content = content.replace(`${matched[i]}`, `<img src=\"${util.urlIllustOriginal(illustId, order)}\">`)\n        }\n    }\n\n    // æ›¿æ¢ Pixiv åˆ†é¡µæ ‡è®°ç¬¦å· [newpage]\n    matched = content.match(RegExp(/[ ã€€]*\\[newpage][ ã€€]*/gm))\n    if (matched) {\n        for (let i in matched){\n            java.log(matched[i])\n            content = content.replace(`${matched[i]}`, `${\"<p>â€‹<p/>\".repeat(3)}`)\n        }\n    }\n\n    // æ›¿æ¢ Pixiv ç« èŠ‚æ ‡è®°ç¬¦å· [chapter:]\n    matched = content.match(RegExp(/\\[chapter:(.*?)]/gm))\n    if (matched) {\n        for (let i in matched) {\n            let matched2 = matched[i].match(/\\[chapter:(.*?)]/m)\n            let chapter = matched2[1].trim()\n            content = content.replace(`${matched[i]}`, `${chapter}<p>â€‹<p/>`)\n        }\n    }\n\n    // æ›¿æ¢ Pixiv è·³è½¬é¡µé¢æ ‡è®°ç¬¦å· [[jump:]]\n    matched = content.match(RegExp(/\\[jump:(\\d+)]/gm))\n    if (matched) {\n        for (let i in matched) {\n            let page = matched[i].match(/\\d+/)\n            content = content.replace(`${matched[i]}`, `\\n\\nè·³è½¬è‡³ç¬¬${page}èŠ‚`)\n        }\n    }\n\n    // æ›¿æ¢ Pixiv é“¾æ¥æ ‡è®°ç¬¦å· [[jumpuri: > ]]\n    matched = content.match(RegExp(/\\[\\[jumpuri:(.*?)>(.*?)]]/gm))\n    if (matched) {\n        for (let i in matched) {\n            let matched2 = matched[i].match(/\\[\\[jumpuri:(.*?)>(.*?)]]/m)\n            let matchedText = matched2[0]\n            let urlName = matched2[1].trim()\n            let urlLink = matched2[2].trim()\n            // é˜…è¯»ä¸æ”¯æŒè¶…é“¾æ¥\n            // content = content.replace(`${matchedText}`, `<a href=${urlLink}>${urlName}</a>`)\n            if (urlLink === urlName) {\n                content = content.replace(`${matchedText}`, `${urlName}`)\n            } else {\n                content = content.replace(`${matchedText}`, `${urlName}: ${urlLink}`)\n            }\n        }\n    }\n\n    // æ›¿æ¢ Pixiv æ³¨éŸ³æ ‡è®°ç¬¦å· [[rb: > ]]\n    matched = content.match(RegExp(/\\[\\[rb:(.*?)>(.*?)]]/gm))\n    if (matched) {\n        for (let i in matched) {\n            let matched2 = matched[i].match(/\\[\\[rb:(.*?)>(.*?)]]/m)\n            let matchedText = matched2[0]\n            let kanji = matched2[1].trim()\n            let kana = matched2[2].trim()\n\n            if (!util.REPLACE_BOOK_TITLE_MARKS) {\n                // é»˜è®¤æ›¿æ¢æˆï¼ˆæ‹¬å·ï¼‰\n                content = content.replace(`${matchedText}`, `${kanji}ï¼ˆ${kana}ï¼‰`)\n            } else {\n                var reg = new RegExp(\"[\\\\u4E00-\\\\u9FFF]+\",\"g\");\n                if (reg.test(kana)) {\n                    // kanaä¸ºä¸­æ–‡ï¼Œåˆ™æ›¿æ¢å›ã€Šä¹¦åå·ã€‹\n                    content = content.replace(`${matchedText}`, `${kanji}ã€Š${kana}ã€‹`)\n                } else {\n                    // é˜…è¯»ä¸æ”¯æŒ <ruby> <rt> æ³¨éŸ³\n                    // content = content.replace(`${matchedText}`, `<ruby>${kanji}<rt>${kana}</rt></ruby>`)\n                    content = content.replace(`${matchedText}`, `${kanji}ï¼ˆ${kana}ï¼‰`)\n                }\n            }\n        }\n    }\n\n    return content\n})(result)",
            "imageStyle": "DEFAULT",
            "replaceRegex": "",
            "sourceRegex": ""
        },
        "ruleExplore": {
            "author": "userName",
            "bookList": "@js:\nvar util = objParse(String(java.get(\"util\")))\nvar seriesSet = new Set();  // å­˜å‚¨seriesID\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\n\n/**\n * @params arr ä¼ å…¥çš„æºæ•°ç»„\n * @params length éœ€è¦è·å–çš„å…ƒç´ çš„ä¸ªæ•°\n */\nfunction randomChoseArrayItem(arr, length) {\n    let copyArr = JSON.parse(JSON.stringify(arr))\n    let newArr = [];\n    for (let i = 0; i < length; i++) {\n        let index = Math.floor(Math.random() * copyArr.length);\n        let item = copyArr[index];\n        newArr.push(item)\n        copyArr.splice(index, 1)\n    }\n    return newArr.reverse()\n}\n\n\nfunction handlerRecommendUsers() {\n    const MAX_FETCH_USER_NUMBER = 2;\n\n    return () => {\n        let userIds = JSON.parse(result).map(i => i.id)\n        // java.log(`ç”¨æˆ·idä¸ªæ•°:${userIds.length}`)\n        if (userIds.length > MAX_FETCH_USER_NUMBER) {\n            userIds = randomChoseArrayItem(userIds, MAX_FETCH_USER_NUMBER);\n        }\n        // java.log(`æŸ¥è¯¢çš„ç”¨æˆ·Ids:${userIds}`)\n        let usersInfo = util.getWebviewJson(util.urlUsersDetailed(userIds))\n        // java.log(`è¿”å›çš„${JSON.stringify(usersInfo)}`)\n        let queryNovelIds = []\n        // java.log(`${JSON.stringify(usersInfo)}`)\n        usersInfo.filter(user => user.novels && user.novels.length > 0)\n            .map(user => user.novels)\n            // å°†listå±•å¹³[1,2,3]å˜ä¸º1,2,3 æ·»åŠ åˆ°novelListä¸­\n            .forEach(novels => {\n                novels.forEach(novel => {\n                    queryNovelIds.push(novel)\n                })\n            })\n        // æš‚æ—¶é™åˆ¶æœ€å¤§è·å–æ•°é‡\n        if (queryNovelIds.length > 10) {\n            queryNovelIds = randomChoseArrayItem(queryNovelIds, 10)\n        }\n        novelList = util.getWebviewJson(util.urlNovelsDetailed(queryNovelIds))\n        return util.formatNovels(util.handNovels(util.combineNovels(novelList)))\n    }\n}\n\nfunction handlerFollowLatest() {\n    return () => {\n        let resp = JSON.parse(result)\n        return util.formatNovels(util.handNovels(util.combineNovels(resp)))\n    }\n}\n\nfunction handlerFactory() {\n    if (baseUrl.indexOf(\"/fav/user\") !== -1) {\n        return handlerRecommendUsers()\n    }\n    if (baseUrl.indexOf(\"/pixiv/novels/recent\") !== -1) {\n        return handlerFollowLatest()\n    }\n}\n\n(() => {\n    return handlerFactory()()\n})()\n",
            "bookUrl": "detailedUrl",
            "coverUrl": "coverUrl",
            "intro": "description",
            "kind": "tags",
            "lastChapter": "latestChapter",
            "name": "title",
            "wordCount": "textCount"
        },
        "ruleSearch": {
            "author": "userName",
            "bookList": "@js:\nvar util = objParse(String(java.get(\"util\")))\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\nfunction getUser(username, exactMatch) {\n    // let resp = util.getAjaxJson(util.urlSearchUsers(String(username)))\n    let resp = java.ajax(util.urlSearchUsers(String(username)))  // å…¼å®¹æœç´¢é“¾æ¥\n    if (resp.startsWith(\"<!DOCTYPE html>\") || JSON.parse(result).error) {\n        return []\n    }\n    resp = JSON.parse(resp)\n    if (resp.users.length === 0) {\n        return []\n    }\n    if (!exactMatch) {\n        return resp.users\n    }\n    // åªè¿”å›ç”¨æˆ·åå®Œå…¨ä¸€æ ·çš„ç”¨æˆ·\n    return resp.users.filter(user => {\n        return user.name === username\n    })\n}\n\nfunction getUserNovels(nidList) {\n    let page = Number(java.get(\"page\"))\n    // åˆ†é¡µ\n    let list = nidList.slice((page - 1) * 20, page * 20)\n    if (list.length === 0) {\n        return []\n    }\n    // java.log(`NIDURL:${util.urlNovelsDetailed(list)}`)\n    return util.getWebviewJson(util.urlNovelsDetailed(list))\n}\n\n// å­˜å‚¨seriesID\nvar first = true;\nvar seriesSet = {\n    keywords: \"Linpx:Search\",\n    has: (value) => {\n        let page = Number(java.get(\"page\"))\n        if (page === 1 && first) {\n            first = false\n            cache.deleteMemory(this.keywords)\n            return false\n        }\n\n        let v = cache.getFromMemory(this.keywords)\n        if (v === undefined || v === null) {\n            return false\n        }\n        let set = new Set(JSON.parse(v))\n        return set.has(value)\n    },\n\n    add: (value) => {\n        let v = cache.getFromMemory(this.keywords)\n        if (v === undefined || v === null) {\n            cache.putMemory(this.keywords, JSON.stringify([value]))\n\n        } else {\n            let arr = JSON.parse(v)\n            if (typeof arr === \"string\") {\n                arr = Array(arr)\n            }\n            arr.push(value)\n            cache.putMemory(this.keywords, JSON.stringify(arr))\n        }\n    },\n};\n\n\nfunction findUserNovels() {\n    let novelList = []\n    let username = String(java.get(\"key\"))\n    let userArr = getUser(username, true)\n    // è·å–ç”¨æˆ·æ‰€æœ‰å°è¯´\n    let uidList = userArr.filter(user => {\n        return user.novels.length > 0\n    }).map(user => user.id)\n\n    if (uidList.length > 0) {\n        let list = util.getWebviewJson(util.urlUsersDetailed(uidList))  // åŒ…å«æ‰€æœ‰å°è¯´æ•°æ®\n        let nidList = []\n        // ä»ä¸¤å±‚æ•°ç»„ä¸­æå–novelsId\n        list.forEach(user => {\n            user.novels\n                // æŒ‰idé™åºæ’åº-ç›¸å½“äºæŒ‰æ—¶é—´é™åºæ’åº\n                .reverse()\n                .forEach(nid => nidList.push(nid))\n        })\n        getUserNovels(nidList).forEach(novel => {\n            novelList.push(novel)\n        })\n    }\n    return novelList\n}\n\nfunction getNovels(){\n    if (result.startsWith(\"<!DOCTYPE html>\") || JSON.parse(result).error) {\n        return []\n    } else {\n        return JSON.parse(result).novels\n    }\n}\n\nfunction getLinkNovels() {\n    try {\n        return util.getNovelRes(String(java.get(\"key\")))\n    } catch (e) {\n        return []\n    }\n}\n\n(function () {\n    let novels = []\n    novels = novels.concat(getNovels())\n    novels = novels.concat(getLinkNovels())\n    novels = novels.concat(findUserNovels())\n    // java.log(JSON.stringify(novels))\n    // è¿”å›ç©ºåˆ—è¡¨ä¸­æ­¢æµç¨‹\n    if (novels.length === 0) {\n        return []\n    }\n    return util.formatNovels(util.handNovels(util.combineNovels(novels)))\n}(result))",
            "bookUrl": "detailedUrl",
            "checkKeyWord": "æµ‹è¯•é¡µé¢",
            "coverUrl": "coverUrl",
            "intro": "description",
            "kind": "tags",
            "lastChapter": "latestChapter",
            "name": "title",
            "wordCount": "textCount"
        },
        "ruleToc": {
            "chapterList": "@js:\nvar util = objParse(String(java.get(\"util\")))\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\nfunction oneShotHandler(res) {\n    res.textCount =ã€€res.content.length\n    res.updateDate = util.timeTextFormat(res.createDate)\n    return [{\n        title: res.title.replace(RegExp(/^\\s+|\\s+$/g), \"\"),\n        chapterUrl: util.urlNovel(res.id),\n        chapterInfo:`${res.updateDate}ã€€ã€€${res.textCount}å­—`\n    }]\n}\n\nfunction seriesHandler(res) {\n    res.novels.forEach(v => {\n        v.title = v.title.replace(RegExp(/^\\s+|\\s+$/g), \"\").replace(RegExp(/ï¼ˆ|ï¼‰|-/g), \"\")\n        v.chapterUrl = util.urlNovel(v.id)\n        // v.updateDate = String(v.coverUrl.match(RegExp(\"\\\\d{4}/\\\\d{2}/\\\\d{2}\")))  //fake\n        v.detail = util.getAjaxJson(util.urlNovelDetailed(v.id))\n        try{\n            v.textCount = v.detail.content.length\n            v.updateDate = util.timeTextFormat(v.detail.createDate)\n            v.chapterInfo = `${v.updateDate}ã€€ã€€${v.textCount}å­—`\n        } catch (e) {}\n        util.debugFunc(() => {\n            java.log(`${v.title}`)\n        })\n    })\n    return res.novels\n}\n\n(function (res) {\n    res = util.getNovelResSeries(result)\n    if (res.novels !== undefined) {\n        return seriesHandler(res)\n    } else {\n        return oneShotHandler(res)\n    }\n})(result)\n",
            "chapterName": "title",
            "chapterUrl": "chapterUrl",
            "updateTime": "chapterInfo"
        },
        "searchUrl": "@js:\njava.put(\"page\",page);java.put(\"key\",key);\n`https://api.furrynovel.ink/pixiv/search/novel/${encodeURI(key)}/cache?page=${page}`;",
        "variableComment": "âš™ï¸ è‡ªå®šä¹‰ä¹¦æºè®¾ç½®ï¼š\nâš™ï¸ è‡ªå®šä¹‰è®¾ç½®ï¼šè¯·åœ¨åŸºæœ¬-å˜é‡è¯´æ˜å¤„ä¿®æ”¹ä»£ç \nâš™ï¸ è‡ªå®šä¹‰è®¾ç½®ï¼šå°† true æ”¹ä¸º falseï¼Œæˆ–ç›¸å\nâš ï¸ è®¾ç½®æºå˜é‡ã€æ— æ³•ã€‘æ›´æ”¹ä¹¦æºè‡ªå®šä¹‰è®¾ç½®\nâš ï¸ æ³¨æ„ä¸è¦æ·»åŠ æˆ–åˆ é™¤å°¾éšé€—å·\",\"\nâš ï¸ å‘ç°é¡µéœ€è¦é•¿æŒ‰\"Pixiv\"ï¼Œæ‰‹åŠ¨åˆ·æ–°\nä»¥ä¸‹å†…å®¹ä¸ºä¹¦æºè®¾ç½®ï¼š\n{\n\"SHOW_ORIGINAL_NOVEL_LINK\": true,\n\"MORE_INFO_IN_DESCRIPTION\": false,\n\"REPLACE_BOOK_TITLE_MARKS\": true,\n\"DEBUG\": false\n}\n\n// SHOW_GENERAL_NOVELS_RANK\n// å‘ç°ï¼šæ˜¾ç¤ºä¸€èˆ¬å°è¯´æ’è¡Œæ¦œ\n// MORE_INFO_IN_DESCRIPTION\n// è¯¦æƒ…ï¼šä¹¦ç±ç®€ä»‹æ˜¾ç¤ºæ›´å¤šä¿¡æ¯\n// SHOW_ORIGINAL_NOVEL_LINK\n// ç›®å½•ï¼šæ˜¾ç¤ºæºé“¾æ¥ï¼Œä½†ä¼šå¢åŠ è¯·æ±‚æ¬¡æ•°\n// REPLACE_BOOK_TITLE_MARKS\n// æ­£æ–‡ï¼šæ³¨éŸ³å†…å®¹ä¸ºæ±‰å­—æ—¶ï¼Œæ›¿æ¢ä¸ºä¹¦åå·\n// DEBUG\n// è°ƒè¯•æ¨¡å¼\n\n",
        "weight": 0
    }
]